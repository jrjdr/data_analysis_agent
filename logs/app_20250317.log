2025-03-17 08:43:18,149 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 08:43:18,150 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 08:43:18,150 - ERROR - __main__ - 程序执行过程中发生错误
Traceback (most recent call last):
  File "D:\smolagent\main.py", line 130, in main
    model = ModelConnector(app_config)
  File "D:\smolagent\modules\model_connector.py", line 29, in __init__
    self.model_config = config['models']['conversational']
                        ~~~~~~^^^^^^^^^^
KeyError: 'models'
2025-03-17 08:43:54,177 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 08:43:54,177 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 08:43:54,178 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 08:43:54,178 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 08:43:54,178 - INFO - __main__ - 初始化Excel分析器
2025-03-17 08:43:54,178 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 08:43:54,178 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 08:43:54,178 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 08:43:54,179 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 08:43:54,179 - INFO - __main__ - 开始分析Excel文件: clothing_sales_data.xlsx
2025-03-17 08:43:54,179 - INFO - modules.excel_analyzer - 开始分析Excel文件: clothing_sales_data.xlsx
2025-03-17 08:43:54,179 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: clothing_sales_data.xlsx
2025-03-17 08:43:54,348 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317084354.csv
2025-03-17 08:43:54,348 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317084354.csv
2025-03-17 08:43:54,354 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 08:43:54,354 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 08:43:54,355 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 08:43:54,355 - ERROR - modules.excel_analyzer - 分析Excel文件时出错: Object of type int64 is not JSON serializable
2025-03-17 08:43:54,356 - INFO - __main__ - 分析完成，报告已保存到: reports/excel_analysis_report_20250317_084354.html
2025-03-17 08:44:30,568 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 08:44:30,568 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 08:44:30,568 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 08:44:30,568 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 08:44:30,568 - INFO - __main__ - 初始化Excel分析器
2025-03-17 08:44:30,569 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 08:44:30,569 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 08:44:30,569 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 08:44:30,569 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 08:44:30,569 - INFO - __main__ - 开始分析Excel文件: clothing_sales_data.xlsx
2025-03-17 08:44:30,569 - INFO - modules.excel_analyzer - 开始分析Excel文件: clothing_sales_data.xlsx
2025-03-17 08:44:30,569 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: clothing_sales_data.xlsx
2025-03-17 08:44:30,728 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317084430.csv
2025-03-17 08:44:30,728 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317084430.csv
2025-03-17 08:44:30,734 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 08:44:30,734 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 08:44:30,735 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 08:44:30,736 - INFO - modules.analysis_dispatcher - 执行分析单元 1/5: 总体数据统计分析单元
2025-03-17 08:44:30,736 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 08:44:30,737 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 08:44:30,737 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 08:44:51,816 - ERROR - modules.model_connector - API流式请求异常 (尝试 1/3): HTTPSConnectionPool(host='xiaohumini.site', port=443): Max retries exceeded with url: /v1/chat/completions (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x00000214A7A7B4D0>, 'Connection to xiaohumini.site timed out. (connect timeout=60)'))
2025-03-17 08:44:51,818 - INFO - modules.model_connector - 2秒后重试...
2025-03-17 08:44:53,820 - INFO - modules.model_connector - 尝试流式调用API (尝试 2/3)...
2025-03-17 08:44:53,821 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 08:44:56,355 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 08:44:56,357 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 08:45:12,312 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 08:45:12,313 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 08:45:12,314 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 08:45:12,314 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 已将生成的代码保存到: temp_py/总体数据统计分析单元_code_20250317084512.py
2025-03-17 08:45:12,315 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 08:45:12,315 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 08:45:12,315 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 08:45:12,653 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 08:45:12,653 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 08:45:12,654 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 08:45:12,655 - INFO - modules.analysis_dispatcher - 执行分析单元 2/5: 柱状图对比分析单元
2025-03-17 08:45:12,655 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 正在生成数据分析代码...
2025-03-17 08:45:12,655 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 08:45:12,655 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 08:45:19,011 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 08:45:19,012 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 08:45:53,442 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 08:45:53,444 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功从Python代码块中提取代码
2025-03-17 08:45:53,444 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功生成数据分析代码
2025-03-17 08:45:53,445 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 已将生成的代码保存到: temp_py/柱状图对比分析单元_code_20250317084553.py
2025-03-17 08:45:53,445 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 开始执行并尝试修复代码...
2025-03-17 08:45:53,445 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 执行代码尝试 1/3
2025-03-17 08:45:53,446 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 在沙箱环境中执行代码...
2025-03-17 08:45:53,805 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功
2025-03-17 08:45:53,805 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功（尝试 1/3）
2025-03-17 08:45:53,806 - INFO - modules.analysis_dispatcher - 分析单元 柱状图对比分析单元 执行成功
2025-03-17 08:45:53,806 - INFO - modules.analysis_dispatcher - 执行分析单元 3/5: 饼图比例分析单元
2025-03-17 08:45:53,806 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 正在生成数据分析代码...
2025-03-17 08:45:53,807 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 08:45:53,807 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 08:46:00,357 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 08:46:00,358 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 08:46:40,564 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 08:46:40,566 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 成功从Python代码块中提取代码
2025-03-17 08:46:40,566 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 成功生成数据分析代码
2025-03-17 08:46:40,567 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 已将生成的代码保存到: temp_py/饼图比例分析单元_code_20250317084640.py
2025-03-17 08:46:40,567 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 开始执行并尝试修复代码...
2025-03-17 08:46:40,568 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 执行代码尝试 1/3
2025-03-17 08:46:40,568 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 在沙箱环境中执行代码...
2025-03-17 08:46:40,909 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 代码执行成功
2025-03-17 08:46:40,909 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 代码执行成功（尝试 1/3）
2025-03-17 08:46:40,910 - INFO - modules.analysis_dispatcher - 分析单元 饼图比例分析单元 执行成功
2025-03-17 08:46:40,910 - INFO - modules.analysis_dispatcher - 执行分析单元 4/5: 时间趋势分析单元
2025-03-17 08:46:40,910 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在生成数据分析代码...
2025-03-17 08:46:40,910 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 08:46:40,910 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 08:46:44,065 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 08:46:44,067 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 08:47:40,985 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 08:47:40,988 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功从Python代码块中提取代码
2025-03-17 08:47:40,988 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功生成数据分析代码
2025-03-17 08:47:40,989 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 已将生成的代码保存到: temp_py/时间趋势分析单元_code_20250317084740.py
2025-03-17 08:47:40,989 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 开始执行并尝试修复代码...
2025-03-17 08:47:40,989 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 执行代码尝试 1/3
2025-03-17 08:47:40,989 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 在沙箱环境中执行代码...
2025-03-17 08:47:41,336 - WARNING - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行失败，错误码: 1
2025-03-17 08:47:41,337 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行失败，尝试修复（尝试 1/3）
2025-03-17 08:47:41,337 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在修复数据分析代码...
2025-03-17 08:47:41,337 - INFO - modules.model_connector - 尝试调用API (尝试 1/3)...
2025-03-17 08:47:41,337 - INFO - modules.model_connector - 直接连接API（无代理）
2025-03-17 08:48:41,983 - ERROR - modules.model_connector - API请求异常 (尝试 1/3): HTTPSConnectionPool(host='xiaohumini.site', port=443): Read timed out. (read timeout=60)
2025-03-17 08:48:41,986 - INFO - modules.model_connector - 2秒后重试...
2025-03-17 08:48:43,988 - INFO - modules.model_connector - 尝试调用API (尝试 2/3)...
2025-03-17 08:48:43,989 - INFO - modules.model_connector - 直接连接API（无代理）
2025-03-17 08:49:44,598 - ERROR - modules.model_connector - API请求异常 (尝试 2/3): HTTPSConnectionPool(host='xiaohumini.site', port=443): Read timed out. (read timeout=60)
2025-03-17 08:49:44,599 - INFO - modules.model_connector - 4秒后重试...
2025-03-17 08:49:48,600 - INFO - modules.model_connector - 尝试调用API (尝试 3/3)...
2025-03-17 08:49:48,601 - INFO - modules.model_connector - 直接连接API（无代理）
2025-03-17 08:50:09,641 - ERROR - modules.model_connector - API请求异常 (尝试 3/3): HTTPSConnectionPool(host='xiaohumini.site', port=443): Max retries exceeded with url: /v1/chat/completions (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x00000214A7BB6710>, 'Connection to xiaohumini.site timed out. (connect timeout=60)'))
2025-03-17 08:50:09,643 - ERROR - modules.model_connector - 达到最大重试次数 (3)，API调用失败
2025-03-17 08:50:09,644 - ERROR - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 修复数据分析代码失败: 模型未返回有效响应
2025-03-17 08:50:09,645 - ERROR - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码修复失败（尝试 1/3）
2025-03-17 08:50:09,646 - ERROR - modules.analysis_dispatcher - 分析单元 时间趋势分析单元 执行代码失败: Traceback (most recent call last):
  File "D:\smolagent\temp_py\时间趋势分析单元_temp_code_20250317084740.py", line 7, in <module>
    from statsmodels.tsa.seasonal import seasonal_decompose
ModuleNotFoundError: No module named 'statsmodels'

2025-03-17 08:50:09,648 - INFO - modules.analysis_dispatcher - 执行分析单元 5/5: 相关性分析单元
2025-03-17 08:50:09,649 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 正在生成数据分析代码...
2025-03-17 08:50:09,650 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 08:50:09,651 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 08:50:13,216 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 08:50:13,217 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 08:50:51,130 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 08:50:51,133 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功从Python代码块中提取代码
2025-03-17 08:50:51,133 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功生成数据分析代码
2025-03-17 08:50:51,134 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 已将生成的代码保存到: temp_py/相关性分析单元_code_20250317085051.py
2025-03-17 08:50:51,134 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 开始执行并尝试修复代码...
2025-03-17 08:50:51,134 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 执行代码尝试 1/3
2025-03-17 08:50:51,134 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 在沙箱环境中执行代码...
2025-03-17 08:50:52,242 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行成功
2025-03-17 08:50:52,242 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行成功（尝试 1/3）
2025-03-17 08:50:52,243 - WARNING - modules.analysis_dispatcher - 无法加载JSON结果文件 correlation_analysis_results.json: Expecting value: line 65 column 24 (char 1303)
2025-03-17 08:50:52,243 - INFO - modules.analysis_dispatcher - 分析单元 相关性分析单元 执行成功
2025-03-17 08:50:52,244 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_084430
2025-03-17 08:50:52,245 - INFO - modules.excel_analyzer - 生成HTML报告...
2025-03-17 08:50:52,245 - INFO - modules.report_generator - 正在生成HTML报告...
2025-03-17 08:50:52,245 - INFO - modules.report_generator - 尝试调用API生成HTML报告...
2025-03-17 08:50:52,245 - INFO - modules.model_connector - 尝试调用API (尝试 1/3)...
2025-03-17 08:50:52,245 - INFO - modules.model_connector - 直接连接API（无代理）
2025-03-17 08:51:12,102 - INFO - modules.model_connector - API响应状态: 200 OK
2025-03-17 08:51:12,103 - INFO - modules.report_generator - 将整个响应作为HTML返回
2025-03-17 08:51:12,103 - INFO - modules.report_generator - 成功生成HTML报告
2025-03-17 08:51:12,104 - INFO - modules.report_generator - 已将HTML报告保存到: reports/analysis_report_20250317085112.html
2025-03-17 08:51:12,104 - INFO - modules.excel_analyzer - 已将报告保存到: reports/excel_analysis_report_20250317085112.html
2025-03-17 08:51:12,107 - INFO - __main__ - 分析完成，报告已保存到: reports/excel_analysis_report_20250317_085112.html
2025-03-17 09:08:57,023 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 09:08:57,023 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 09:08:57,023 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 09:08:57,023 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 09:08:57,024 - INFO - __main__ - 初始化Excel分析器
2025-03-17 09:08:57,024 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 09:08:57,024 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 09:08:57,024 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 09:08:57,024 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 09:08:57,024 - INFO - __main__ - 开始分析Excel文件: clothing_sales_data.xlsx
2025-03-17 09:08:57,024 - INFO - modules.excel_analyzer - 开始分析Excel文件: clothing_sales_data.xlsx
2025-03-17 09:08:57,024 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: clothing_sales_data.xlsx
2025-03-17 09:08:57,190 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317090857.csv
2025-03-17 09:08:57,190 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317090857.csv
2025-03-17 09:08:57,196 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 09:08:57,197 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 09:08:57,197 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 09:08:57,198 - INFO - modules.analysis_dispatcher - 执行分析单元 1/5: 总体数据统计分析单元
2025-03-17 09:08:57,198 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 09:08:57,198 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 09:08:57,199 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 09:08:57,199 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 09:09:00,317 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 09:09:00,319 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 09:09:32,481 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 09:09:32,552 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 09:09:32,552 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 09:09:32,553 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 09:09:32,553 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 09:09:32,553 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 09:09:32,951 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 09:09:32,951 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 09:09:32,951 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 09:09:32,952 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 09:09:32,953 - INFO - modules.analysis_dispatcher - 执行分析单元 2/5: 柱状图对比分析单元
2025-03-17 09:09:32,953 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 正在生成数据分析代码...
2025-03-17 09:09:32,953 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 09:09:32,953 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 09:09:32,953 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 09:09:36,283 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 09:09:36,283 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 09:10:09,131 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 09:10:09,220 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功从Python代码块中提取代码
2025-03-17 09:10:09,220 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功生成数据分析代码
2025-03-17 09:10:09,220 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 开始执行并尝试修复代码...
2025-03-17 09:10:09,221 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 执行代码尝试 1/3
2025-03-17 09:10:09,221 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 在沙箱环境中执行代码...
2025-03-17 09:10:09,726 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功
2025-03-17 09:10:09,727 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功（尝试 1/3）
2025-03-17 09:10:09,727 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_柱状图对比分析单元_conclusion.txt
2025-03-17 09:10:09,728 - INFO - modules.analysis_dispatcher - 分析单元 柱状图对比分析单元 执行成功
2025-03-17 09:10:09,728 - INFO - modules.analysis_dispatcher - 执行分析单元 3/5: 饼图比例分析单元
2025-03-17 09:10:09,729 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 正在生成数据分析代码...
2025-03-17 09:10:09,729 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 09:10:09,729 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 09:10:09,729 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 09:10:12,648 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 09:10:12,649 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 09:10:47,194 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 09:10:47,344 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 成功从Python代码块中提取代码
2025-03-17 09:10:47,345 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 成功生成数据分析代码
2025-03-17 09:10:47,345 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 开始执行并尝试修复代码...
2025-03-17 09:10:47,346 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 执行代码尝试 1/3
2025-03-17 09:10:47,346 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 在沙箱环境中执行代码...
2025-03-17 09:10:47,722 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 代码执行成功
2025-03-17 09:10:47,722 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 代码执行成功（尝试 1/3）
2025-03-17 09:10:47,723 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\3_饼图比例分析单元_conclusion.txt
2025-03-17 09:10:47,724 - INFO - modules.analysis_dispatcher - 分析单元 饼图比例分析单元 执行成功
2025-03-17 09:10:47,724 - INFO - modules.analysis_dispatcher - 执行分析单元 4/5: 时间趋势分析单元
2025-03-17 09:10:47,724 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在生成数据分析代码...
2025-03-17 09:10:47,724 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 09:10:47,724 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 09:10:47,724 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 09:10:51,233 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 09:10:51,235 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 09:11:45,772 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 09:11:45,907 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功从Python代码块中提取代码
2025-03-17 09:11:45,907 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功生成数据分析代码
2025-03-17 09:11:45,907 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 开始执行并尝试修复代码...
2025-03-17 09:11:45,908 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 执行代码尝试 1/3
2025-03-17 09:11:45,908 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 在沙箱环境中执行代码...
2025-03-17 09:11:46,248 - WARNING - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行失败，错误码: 1
2025-03-17 09:11:46,249 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行失败，尝试修复（尝试 1/3）
2025-03-17 09:11:46,249 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在修复数据分析代码...
2025-03-17 09:11:46,249 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 尝试调用API修复代码（流式输出）...
2025-03-17 09:11:46,249 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 09:11:46,249 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 09:11:49,834 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 09:11:49,834 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 09:12:51,675 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 09:12:51,819 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功从Python代码块中提取代码
2025-03-17 09:12:51,819 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功修复数据分析代码
2025-03-17 09:12:51,819 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 执行代码尝试 2/3
2025-03-17 09:12:51,819 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 在沙箱环境中执行代码...
2025-03-17 09:12:52,154 - WARNING - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行失败，错误码: 1
2025-03-17 09:12:52,154 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行失败，尝试修复（尝试 2/3）
2025-03-17 09:12:52,154 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在修复数据分析代码...
2025-03-17 09:12:52,155 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 尝试调用API修复代码（流式输出）...
2025-03-17 09:12:52,155 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 09:12:52,155 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 09:12:56,013 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 09:12:56,016 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 09:14:05,129 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 09:14:05,277 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功从Python代码块中提取代码
2025-03-17 09:14:05,277 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功修复数据分析代码
2025-03-17 09:14:05,278 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 执行代码尝试 3/3
2025-03-17 09:14:05,278 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 在沙箱环境中执行代码...
2025-03-17 09:14:05,602 - WARNING - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行失败，错误码: 1
2025-03-17 09:14:05,602 - WARNING - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 达到最大尝试次数 (3)，终止修复流程
2025-03-17 09:14:05,602 - ERROR - modules.analysis_dispatcher - 分析单元 时间趋势分析单元 执行代码失败: 
2025-03-17 09:14:05,603 - INFO - modules.analysis_dispatcher - 执行分析单元 5/5: 相关性分析单元
2025-03-17 09:14:05,603 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 正在生成数据分析代码...
2025-03-17 09:14:05,603 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 09:14:05,603 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 09:14:05,603 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 09:14:11,238 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 09:14:11,240 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 09:14:59,486 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 09:14:59,599 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功从Python代码块中提取代码
2025-03-17 09:14:59,599 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功生成数据分析代码
2025-03-17 09:14:59,600 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 开始执行并尝试修复代码...
2025-03-17 09:14:59,601 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 执行代码尝试 1/3
2025-03-17 09:14:59,601 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 在沙箱环境中执行代码...
2025-03-17 09:15:00,450 - WARNING - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行失败，错误码: 1
2025-03-17 09:15:00,451 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行失败，尝试修复（尝试 1/3）
2025-03-17 09:15:00,451 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 正在修复数据分析代码...
2025-03-17 09:15:00,451 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 尝试调用API修复代码（流式输出）...
2025-03-17 09:15:00,452 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 09:15:00,452 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 09:15:03,832 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 09:15:03,833 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 09:16:00,797 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 09:16:00,925 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功从Python代码块中提取代码
2025-03-17 09:16:00,926 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功修复数据分析代码
2025-03-17 09:16:00,926 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 执行代码尝试 2/3
2025-03-17 09:16:00,926 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 在沙箱环境中执行代码...
2025-03-17 09:16:01,840 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行成功
2025-03-17 09:16:01,840 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行成功（尝试 2/3）
2025-03-17 09:16:01,841 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\5_相关性分析单元_conclusion.txt
2025-03-17 09:16:01,842 - WARNING - modules.analysis_dispatcher - 无法加载JSON结果文件 correlation_analysis_results.json: Expecting value: line 99 column 22 (char 2165)
2025-03-17 09:16:01,842 - INFO - modules.analysis_dispatcher - 分析单元 相关性分析单元 执行成功
2025-03-17 09:16:01,844 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_090857
2025-03-17 09:16:01,844 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 4/5
2025-03-17 09:16:01,844 - INFO - modules.excel_analyzer - 生成HTML报告...
2025-03-17 09:16:01,844 - INFO - modules.report_generator - 正在生成HTML报告...
2025-03-17 09:16:01,845 - INFO - modules.report_generator - 读取临时文本文件中的分析结论...
2025-03-17 09:16:01,845 - INFO - modules.report_generator - 尝试调用API生成HTML报告（流式输出）...
2025-03-17 09:16:01,846 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 09:16:01,846 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 09:16:06,790 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 09:16:06,791 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 09:17:05,440 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 09:17:05,635 - INFO - modules.report_generator - 成功从HTML代码块中提取代码
2025-03-17 09:17:05,635 - INFO - modules.report_generator - 成功生成HTML报告
2025-03-17 09:17:05,636 - INFO - modules.report_generator - 已将HTML报告保存到: reports/analysis_report_20250317091705.html
2025-03-17 09:17:05,636 - INFO - modules.excel_analyzer - 已将报告保存到: reports/excel_analysis_report_20250317091705.html
2025-03-17 09:17:05,637 - INFO - __main__ - 分析完成，报告已保存到: reports/excel_analysis_report_20250317_091705.html
2025-03-17 09:35:35,583 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 09:35:35,584 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 09:35:35,584 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 09:35:35,584 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 09:35:35,584 - INFO - __main__ - 初始化Excel分析器
2025-03-17 09:35:35,584 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 09:35:35,584 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 09:35:35,584 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 09:35:35,584 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 09:35:35,585 - INFO - __main__ - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 09:35:35,585 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 09:35:35,585 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 09:35:36,520 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317093536.csv
2025-03-17 09:35:36,520 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317093536.csv
2025-03-17 09:35:36,560 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 09:35:36,561 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 09:35:36,561 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 09:35:36,562 - INFO - modules.analysis_dispatcher - 执行分析单元 1/5: 总体数据统计分析单元
2025-03-17 09:35:36,562 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 09:35:36,562 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 09:35:36,563 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 09:35:36,563 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 09:35:39,225 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 09:35:39,228 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 09:36:11,193 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 09:36:11,270 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 09:36:11,271 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 09:36:11,271 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 09:36:11,271 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 09:36:11,271 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 09:36:11,677 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 09:36:11,678 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 09:36:11,679 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 09:36:11,681 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 09:36:11,681 - INFO - modules.analysis_dispatcher - 执行分析单元 2/5: 柱状图对比分析单元
2025-03-17 09:36:11,681 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 正在生成数据分析代码...
2025-03-17 09:36:11,681 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 09:36:11,681 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 09:36:11,682 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 09:36:14,711 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 09:36:14,714 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 09:36:33,406 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 09:36:33,477 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功从Python代码块中提取代码
2025-03-17 09:36:33,478 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功生成数据分析代码
2025-03-17 09:36:33,478 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 开始执行并尝试修复代码...
2025-03-17 09:36:33,479 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 执行代码尝试 1/3
2025-03-17 09:36:33,479 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 在沙箱环境中执行代码...
2025-03-17 09:36:33,866 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功
2025-03-17 09:36:33,866 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功（尝试 1/3）
2025-03-17 09:36:33,867 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_柱状图对比分析单元_conclusion.txt
2025-03-17 09:36:33,868 - INFO - modules.analysis_dispatcher - 分析单元 柱状图对比分析单元 执行成功
2025-03-17 09:36:33,868 - INFO - modules.analysis_dispatcher - 执行分析单元 3/5: 饼图比例分析单元
2025-03-17 09:36:33,868 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 正在生成数据分析代码...
2025-03-17 09:36:33,868 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 09:36:33,869 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 09:36:33,869 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 09:36:38,890 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 09:36:38,893 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 09:36:50,429 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 09:36:50,477 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 成功从Python代码块中提取代码
2025-03-17 09:36:50,477 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 成功生成数据分析代码
2025-03-17 09:36:50,477 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 开始执行并尝试修复代码...
2025-03-17 09:36:50,478 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 执行代码尝试 1/3
2025-03-17 09:36:50,478 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 在沙箱环境中执行代码...
2025-03-17 09:36:50,864 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 代码执行成功
2025-03-17 09:36:50,864 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 代码执行成功（尝试 1/3）
2025-03-17 09:36:50,865 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\3_饼图比例分析单元_conclusion.txt
2025-03-17 09:36:50,866 - INFO - modules.analysis_dispatcher - 分析单元 饼图比例分析单元 执行成功
2025-03-17 09:36:50,866 - INFO - modules.analysis_dispatcher - 执行分析单元 4/5: 时间趋势分析单元
2025-03-17 09:36:50,866 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在生成数据分析代码...
2025-03-17 09:36:50,867 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 09:36:50,867 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 09:36:50,867 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 09:36:54,073 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 09:36:54,074 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 09:37:17,872 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 09:37:17,985 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功从Python代码块中提取代码
2025-03-17 09:37:17,985 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功生成数据分析代码
2025-03-17 09:37:17,986 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 开始执行并尝试修复代码...
2025-03-17 09:37:17,986 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 执行代码尝试 1/3
2025-03-17 09:37:17,986 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 在沙箱环境中执行代码...
2025-03-17 09:37:18,958 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功
2025-03-17 09:37:18,959 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功（尝试 1/3）
2025-03-17 09:37:18,960 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\4_时间趋势分析单元_conclusion.txt
2025-03-17 09:37:18,960 - INFO - modules.analysis_dispatcher - 分析单元 时间趋势分析单元 执行成功
2025-03-17 09:37:18,961 - INFO - modules.analysis_dispatcher - 执行分析单元 5/5: 相关性分析单元
2025-03-17 09:37:18,961 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 正在生成数据分析代码...
2025-03-17 09:37:18,962 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 09:37:18,962 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 09:37:18,962 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 09:37:22,095 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 09:37:22,098 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 09:37:47,740 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 09:37:47,847 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功从Python代码块中提取代码
2025-03-17 09:37:47,847 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功生成数据分析代码
2025-03-17 09:37:47,848 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 开始执行并尝试修复代码...
2025-03-17 09:37:47,848 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 执行代码尝试 1/3
2025-03-17 09:37:47,848 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 在沙箱环境中执行代码...
2025-03-17 09:37:49,042 - WARNING - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行失败，错误码: 1
2025-03-17 09:37:49,042 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行失败，尝试修复（尝试 1/3）
2025-03-17 09:37:49,042 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 正在修复数据分析代码...
2025-03-17 09:37:49,042 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 尝试调用API修复代码（流式输出）...
2025-03-17 09:37:49,043 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 09:37:49,043 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 09:37:51,997 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 09:37:51,997 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 09:38:19,887 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 09:38:20,003 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功从Python代码块中提取代码
2025-03-17 09:38:20,003 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功修复数据分析代码
2025-03-17 09:38:20,003 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 执行代码尝试 2/3
2025-03-17 09:38:20,003 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 在沙箱环境中执行代码...
2025-03-17 09:38:21,290 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行成功
2025-03-17 09:38:21,290 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行成功（尝试 2/3）
2025-03-17 09:38:21,291 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\5_相关性分析单元_conclusion.txt
2025-03-17 09:38:21,298 - INFO - modules.analysis_dispatcher - 分析单元 相关性分析单元 执行成功
2025-03-17 09:38:21,304 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_093536
2025-03-17 09:38:21,304 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 5/5
2025-03-17 09:38:21,306 - INFO - modules.excel_analyzer - 生成HTML报告...
2025-03-17 09:38:21,306 - INFO - modules.report_generator - 正在生成HTML报告...
2025-03-17 09:38:21,306 - INFO - modules.report_generator - 读取临时文本文件中的分析结论...
2025-03-17 09:38:21,307 - INFO - modules.report_generator - 尝试调用API生成HTML报告（流式输出）...
2025-03-17 09:38:21,307 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 09:38:21,307 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 09:38:28,698 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 09:38:28,700 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 09:40:03,459 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 09:40:03,548 - INFO - modules.report_generator - 检测到HTML标签，将响应作为HTML返回
2025-03-17 09:40:03,548 - INFO - modules.report_generator - 成功生成HTML报告
2025-03-17 09:40:03,549 - INFO - modules.report_generator - 已将HTML报告保存到: reports/analysis_report_20250317094003.html
2025-03-17 09:40:03,550 - INFO - modules.excel_analyzer - 已将报告保存到: reports/excel_analysis_report_20250317094003.html
2025-03-17 09:40:03,551 - INFO - __main__ - 分析完成，报告已保存到: reports/excel_analysis_report_20250317_094003.html
2025-03-17 11:07:56,636 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 11:07:56,637 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 11:07:56,637 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 11:07:56,637 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 11:07:56,637 - INFO - __main__ - 初始化Excel分析器
2025-03-17 11:07:56,638 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 11:07:56,638 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 11:07:56,638 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 11:07:56,638 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 11:07:56,638 - INFO - __main__ - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 11:07:56,639 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 11:07:56,639 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 11:07:57,512 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317110757.csv
2025-03-17 11:07:57,513 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317110757.csv
2025-03-17 11:07:57,553 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 11:07:57,553 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 11:07:57,553 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 11:07:57,554 - INFO - modules.analysis_dispatcher - 执行分析单元 1/5: 总体数据统计分析单元
2025-03-17 11:07:57,554 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 11:07:57,555 - ERROR - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行过程中出错: Object of type int64 is not JSON serializable
2025-03-17 11:07:57,555 - INFO - modules.analysis_dispatcher - 执行分析单元 2/5: 柱状图对比分析单元
2025-03-17 11:07:57,555 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 正在生成数据分析代码...
2025-03-17 11:07:57,555 - ERROR - modules.analysis_dispatcher - 分析单元 柱状图对比分析单元 执行过程中出错: Object of type int64 is not JSON serializable
2025-03-17 11:07:57,555 - INFO - modules.analysis_dispatcher - 执行分析单元 3/5: 饼图比例分析单元
2025-03-17 11:07:57,555 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 正在生成数据分析代码...
2025-03-17 11:07:57,555 - ERROR - modules.analysis_dispatcher - 分析单元 饼图比例分析单元 执行过程中出错: Object of type int64 is not JSON serializable
2025-03-17 11:07:57,556 - INFO - modules.analysis_dispatcher - 执行分析单元 4/5: 时间趋势分析单元
2025-03-17 11:07:57,556 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在生成数据分析代码...
2025-03-17 11:07:57,556 - ERROR - modules.analysis_dispatcher - 分析单元 时间趋势分析单元 执行过程中出错: 子类必须实现get_prompt方法
2025-03-17 11:07:57,556 - INFO - modules.analysis_dispatcher - 执行分析单元 5/5: 相关性分析单元
2025-03-17 11:07:57,556 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 正在生成数据分析代码...
2025-03-17 11:07:57,556 - ERROR - modules.analysis_dispatcher - 分析单元 相关性分析单元 执行过程中出错: Object of type int64 is not JSON serializable
2025-03-17 11:07:57,557 - ERROR - modules.analysis_dispatcher - 所有分析单元执行失败，无法继续流程
2025-03-17 11:07:57,557 - ERROR - modules.excel_analyzer - 所有分析单元执行失败
2025-03-17 11:07:57,557 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_110757.md
2025-03-17 11:10:46,733 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 11:10:46,733 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 11:10:46,733 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 11:10:46,733 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 11:10:46,733 - INFO - __main__ - 初始化Excel分析器
2025-03-17 11:10:46,733 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 11:10:46,734 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 11:10:46,734 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 11:10:46,734 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 11:10:46,734 - INFO - __main__ - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 11:10:46,734 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 11:10:46,734 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 11:10:47,608 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317111047.csv
2025-03-17 11:10:47,609 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317111047.csv
2025-03-17 11:10:47,652 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 11:10:47,653 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 11:10:47,653 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 11:10:47,654 - INFO - modules.analysis_dispatcher - 执行分析单元 1/5: 总体数据统计分析单元
2025-03-17 11:10:47,654 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 11:10:47,655 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 11:10:47,655 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 11:10:47,655 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 11:10:53,271 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 11:10:53,272 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 11:11:06,255 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 11:11:06,257 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 11:11:06,257 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 11:11:06,257 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 11:11:06,257 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 11:11:06,258 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 11:11:08,513 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 11:11:08,514 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 11:11:08,516 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 11:11:08,517 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 11:11:08,517 - INFO - modules.analysis_dispatcher - 执行分析单元 2/5: 柱状图对比分析单元
2025-03-17 11:11:08,517 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 正在生成数据分析代码...
2025-03-17 11:11:08,518 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 11:11:08,518 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 11:11:08,518 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 11:11:12,086 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 11:11:12,087 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 11:11:58,776 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 11:11:58,777 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功从Python代码块中提取代码
2025-03-17 11:11:58,778 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功生成数据分析代码
2025-03-17 11:11:58,778 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 开始执行并尝试修复代码...
2025-03-17 11:11:58,778 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 执行代码尝试 1/3
2025-03-17 11:11:58,778 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 在沙箱环境中执行代码...
2025-03-17 11:12:00,256 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功
2025-03-17 11:12:00,257 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功（尝试 1/3）
2025-03-17 11:12:00,257 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_柱状图对比分析单元_conclusion.txt
2025-03-17 11:12:00,259 - INFO - modules.analysis_dispatcher - 分析单元 柱状图对比分析单元 执行成功
2025-03-17 11:12:00,259 - INFO - modules.analysis_dispatcher - 执行分析单元 3/5: 饼图比例分析单元
2025-03-17 11:12:00,259 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 正在生成数据分析代码...
2025-03-17 11:12:00,260 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 11:12:00,260 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 11:12:00,260 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 11:12:05,043 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 11:12:05,043 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 11:12:52,413 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 11:12:52,414 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 成功从Python代码块中提取代码
2025-03-17 11:12:52,415 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 成功生成数据分析代码
2025-03-17 11:12:52,415 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 开始执行并尝试修复代码...
2025-03-17 11:12:52,416 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 执行代码尝试 1/3
2025-03-17 11:12:52,416 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 在沙箱环境中执行代码...
2025-03-17 11:12:53,606 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 代码执行成功
2025-03-17 11:12:53,606 - INFO - modules.analysis_units.base_analysis_unit - [饼图比例分析单元] 代码执行成功（尝试 1/3）
2025-03-17 11:12:53,607 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\3_饼图比例分析单元_conclusion.txt
2025-03-17 11:12:53,608 - INFO - modules.analysis_dispatcher - 分析单元 饼图比例分析单元 执行成功
2025-03-17 11:12:53,608 - INFO - modules.analysis_dispatcher - 执行分析单元 4/5: 时间趋势分析单元
2025-03-17 11:12:53,608 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在生成数据分析代码...
2025-03-17 11:12:53,609 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 11:12:53,609 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 11:12:53,609 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 11:12:57,001 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 11:12:57,002 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 11:13:48,949 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 11:13:48,951 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功从Python代码块中提取代码
2025-03-17 11:13:48,951 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功生成数据分析代码
2025-03-17 11:13:48,951 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 开始执行并尝试修复代码...
2025-03-17 11:13:48,951 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 执行代码尝试 1/3
2025-03-17 11:13:48,952 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 在沙箱环境中执行代码...
2025-03-17 11:13:50,296 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功
2025-03-17 11:13:50,296 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功（尝试 1/3）
2025-03-17 11:13:50,297 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\4_时间趋势分析单元_conclusion.txt
2025-03-17 11:13:50,302 - INFO - modules.analysis_dispatcher - 分析单元 时间趋势分析单元 执行成功
2025-03-17 11:13:50,302 - INFO - modules.analysis_dispatcher - 执行分析单元 5/5: 相关性分析单元
2025-03-17 11:13:50,303 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 正在生成数据分析代码...
2025-03-17 11:13:50,303 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 11:13:50,303 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 11:13:50,303 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 11:13:53,938 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 11:13:53,940 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 11:14:56,204 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 11:14:56,205 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功从Python代码块中提取代码
2025-03-17 11:14:56,205 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功生成数据分析代码
2025-03-17 11:14:56,206 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 开始执行并尝试修复代码...
2025-03-17 11:14:56,206 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 执行代码尝试 1/3
2025-03-17 11:14:56,206 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 在沙箱环境中执行代码...
2025-03-17 11:15:03,101 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行成功
2025-03-17 11:15:03,102 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行成功（尝试 1/3）
2025-03-17 11:15:03,103 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\5_相关性分析单元_conclusion.txt
2025-03-17 11:15:03,104 - INFO - modules.analysis_dispatcher - 分析单元 相关性分析单元 执行成功
2025-03-17 11:15:03,109 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_111047
2025-03-17 11:15:03,109 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 5/5
2025-03-17 11:15:03,111 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 11:15:03,111 - ERROR - modules.excel_analyzer - 分析Excel文件时出错: EnhancedMarkdownReportGenerator.generate_markdown_report() takes 2 positional arguments but 3 were given
2025-03-17 11:15:03,112 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_111503.md
2025-03-17 11:31:15,618 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 11:31:15,618 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 11:31:15,619 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 11:31:15,619 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 11:31:15,619 - INFO - __main__ - 初始化Excel分析器
2025-03-17 11:31:15,619 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 11:31:15,619 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 11:31:15,619 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 11:31:15,619 - INFO - modules.analysis_dispatcher - 成功初始化 2 个分析单元
2025-03-17 11:31:15,620 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 11:31:15,620 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 11:31:15,620 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 11:31:15,620 - INFO - modules.analysis_dispatcher - 成功初始化 2 个分析单元
2025-03-17 11:31:15,620 - INFO - __main__ - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 11:31:15,620 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 11:31:15,620 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 11:31:16,505 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317113116.csv
2025-03-17 11:31:16,505 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317113116.csv
2025-03-17 11:31:16,547 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 11:31:16,547 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 11:31:16,547 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 11:31:16,549 - INFO - modules.analysis_dispatcher - 执行分析单元 1/2: 总体数据统计分析单元
2025-03-17 11:31:16,549 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 11:31:16,549 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 11:31:16,549 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 11:31:16,549 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 11:31:19,441 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 11:31:19,441 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 11:31:45,746 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 11:31:45,748 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 11:31:45,748 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 11:31:45,748 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 11:31:45,749 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 11:31:45,750 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 11:31:47,364 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 11:31:47,364 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 11:31:47,365 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 11:31:47,367 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 11:31:47,367 - INFO - modules.analysis_dispatcher - 执行分析单元 2/2: 柱状图对比分析单元
2025-03-17 11:31:47,367 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 正在生成数据分析代码...
2025-03-17 11:31:47,367 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 11:31:47,368 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 11:31:47,368 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 11:31:49,994 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 11:31:49,997 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 11:32:16,184 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 11:32:16,187 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功从Python代码块中提取代码
2025-03-17 11:32:16,187 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功生成数据分析代码
2025-03-17 11:32:16,187 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 开始执行并尝试修复代码...
2025-03-17 11:32:16,188 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 执行代码尝试 1/3
2025-03-17 11:32:16,188 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 在沙箱环境中执行代码...
2025-03-17 11:32:17,549 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功
2025-03-17 11:32:17,550 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功（尝试 1/3）
2025-03-17 11:32:17,550 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_柱状图对比分析单元_conclusion.txt
2025-03-17 11:32:17,552 - INFO - modules.analysis_dispatcher - 分析单元 柱状图对比分析单元 执行成功
2025-03-17 11:32:17,553 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_113116
2025-03-17 11:32:17,553 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 2/2
2025-03-17 11:32:17,554 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 11:32:17,554 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 11:32:17,554 - ERROR - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告时出错: 'EnhancedMarkdownReportGenerator' object has no attribute 'generate_html_report'
2025-03-17 11:32:17,554 - ERROR - modules.excel_analyzer - 分析Excel文件时出错: write() argument must be str, not None
2025-03-17 11:32:17,555 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_113217.md
2025-03-17 11:33:51,703 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 11:33:51,703 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 11:33:51,703 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 11:33:51,703 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 11:33:51,703 - INFO - __main__ - 初始化Excel分析器
2025-03-17 11:33:51,703 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 11:33:51,703 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 11:33:51,704 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 11:33:51,704 - INFO - modules.analysis_dispatcher - 成功初始化 2 个分析单元
2025-03-17 11:33:51,704 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 11:33:51,704 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 11:33:51,704 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 11:33:51,704 - INFO - modules.analysis_dispatcher - 成功初始化 2 个分析单元
2025-03-17 11:33:51,704 - INFO - __main__ - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 11:33:51,704 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 11:33:51,704 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 11:33:52,588 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317113352.csv
2025-03-17 11:33:52,589 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317113352.csv
2025-03-17 11:33:52,631 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 11:33:52,632 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 11:33:52,632 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 11:33:52,633 - INFO - modules.analysis_dispatcher - 执行分析单元 1/2: 总体数据统计分析单元
2025-03-17 11:33:52,633 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 11:33:52,633 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 11:33:52,634 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 11:33:52,634 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 11:33:55,623 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 11:33:55,624 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 11:34:49,268 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 11:34:49,269 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 11:34:49,269 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 11:34:49,270 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 11:34:49,271 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 11:34:49,272 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 11:34:51,653 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 11:34:51,654 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 11:34:51,655 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 11:34:51,656 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 11:34:51,656 - INFO - modules.analysis_dispatcher - 执行分析单元 2/2: 柱状图对比分析单元
2025-03-17 11:34:51,656 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 正在生成数据分析代码...
2025-03-17 11:34:51,656 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 11:34:51,657 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 11:34:51,657 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 11:34:54,926 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 11:34:54,928 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 11:35:51,386 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 11:35:51,388 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功从Python代码块中提取代码
2025-03-17 11:35:51,388 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功生成数据分析代码
2025-03-17 11:35:51,389 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 开始执行并尝试修复代码...
2025-03-17 11:35:51,389 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 执行代码尝试 1/3
2025-03-17 11:35:51,390 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 在沙箱环境中执行代码...
2025-03-17 11:35:52,804 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功
2025-03-17 11:35:52,804 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功（尝试 1/3）
2025-03-17 11:35:52,805 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_柱状图对比分析单元_conclusion.txt
2025-03-17 11:35:52,807 - INFO - modules.analysis_dispatcher - 分析单元 柱状图对比分析单元 执行成功
2025-03-17 11:35:52,808 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_113352
2025-03-17 11:35:52,809 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 2/2
2025-03-17 11:35:52,809 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 11:35:52,809 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 11:35:52,809 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成HTML报告...
2025-03-17 11:35:52,810 - INFO - modules.enhanced_markdown_report_generator - 已将HTML报告保存到: reports\html_report_20250317113552.html
2025-03-17 11:35:52,810 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 11:35:52,811 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 11:35:52,811 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 11:35:55,663 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 11:35:55,664 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 11:35:55,665 - ERROR - modules.enhanced_markdown_report_generator - 生成Markdown内容时出错: 'str' object has no attribute 'get'
2025-03-17 11:35:55,667 - WARNING - modules.enhanced_markdown_report_generator - Markdown验证失败: expected string or bytes-like object, got 'NoneType'
2025-03-17 11:35:55,668 - WARNING - modules.enhanced_markdown_report_generator - Markdown验证失败: expected string or bytes-like object, got 'NoneType'
2025-03-17 11:35:55,669 - WARNING - modules.enhanced_markdown_report_generator - 无法提取有效的Markdown，返回原始内容
2025-03-17 11:35:55,670 - ERROR - modules.enhanced_markdown_report_generator - 无法提取有效的Markdown内容
2025-03-17 11:35:55,671 - ERROR - modules.excel_analyzer - 分析Excel文件时出错: write() argument must be str, not None
2025-03-17 11:35:55,672 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_113555.md
2025-03-17 11:36:50,538 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 11:36:50,538 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 11:36:50,538 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 11:36:50,538 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 11:36:50,539 - INFO - __main__ - 初始化Excel分析器
2025-03-17 11:36:50,539 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 11:36:50,539 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 11:36:50,539 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 11:36:50,539 - INFO - modules.analysis_dispatcher - 成功初始化 2 个分析单元
2025-03-17 11:36:50,539 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 11:36:50,539 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 11:36:50,539 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 11:36:50,539 - INFO - modules.analysis_dispatcher - 成功初始化 2 个分析单元
2025-03-17 11:36:50,540 - INFO - __main__ - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 11:36:50,540 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 11:36:50,540 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 11:36:51,437 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317113651.csv
2025-03-17 11:36:51,437 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317113651.csv
2025-03-17 11:36:51,478 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 11:36:51,479 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 11:36:51,479 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 11:36:51,480 - INFO - modules.analysis_dispatcher - 执行分析单元 1/2: 总体数据统计分析单元
2025-03-17 11:36:51,481 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 11:36:51,481 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 11:36:51,481 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 11:36:51,481 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 11:36:55,373 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 11:36:55,374 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 11:37:38,049 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 11:37:38,051 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 11:37:38,051 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 11:37:38,052 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 11:37:38,052 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 11:37:38,052 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 11:37:40,289 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 11:37:40,290 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 11:37:40,291 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 11:37:40,292 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 11:37:40,293 - INFO - modules.analysis_dispatcher - 执行分析单元 2/2: 柱状图对比分析单元
2025-03-17 11:37:40,293 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 正在生成数据分析代码...
2025-03-17 11:37:40,293 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 11:37:40,293 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 11:37:40,293 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 11:37:44,261 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 11:37:44,262 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 11:38:27,979 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 11:38:27,981 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功从Python代码块中提取代码
2025-03-17 11:38:27,981 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功生成数据分析代码
2025-03-17 11:38:27,981 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 开始执行并尝试修复代码...
2025-03-17 11:38:27,982 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 执行代码尝试 1/3
2025-03-17 11:38:27,982 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 在沙箱环境中执行代码...
2025-03-17 11:38:29,309 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功
2025-03-17 11:38:29,310 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功（尝试 1/3）
2025-03-17 11:38:29,311 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_柱状图对比分析单元_conclusion.txt
2025-03-17 11:38:29,312 - INFO - modules.analysis_dispatcher - 分析单元 柱状图对比分析单元 执行成功
2025-03-17 11:38:29,315 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_113651
2025-03-17 11:38:29,315 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 2/2
2025-03-17 11:38:29,315 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 11:38:29,316 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 11:38:29,316 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成HTML报告...
2025-03-17 11:38:29,316 - INFO - modules.enhanced_markdown_report_generator - 已将HTML报告保存到: reports\html_report_20250317113829.html
2025-03-17 11:38:29,316 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 11:38:29,317 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 11:38:29,317 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 11:38:50,360 - ERROR - modules.model_connector - API流式请求异常 (尝试 1/3): HTTPSConnectionPool(host='xiaohumini.site', port=443): Max retries exceeded with url: /v1/chat/completions (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x00000215F3A1A350>, 'Connection to xiaohumini.site timed out. (connect timeout=60)'))
2025-03-17 11:38:50,364 - INFO - modules.model_connector - 2秒后重试...
2025-03-17 11:38:52,366 - INFO - modules.model_connector - 尝试流式调用API (尝试 2/3)...
2025-03-17 11:38:52,367 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 11:38:57,225 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 11:38:57,226 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 11:38:58,920 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 11:38:58,922 - WARNING - modules.enhanced_markdown_report_generator - Markdown验证失败: expected string or bytes-like object, got 'NoneType'
2025-03-17 11:38:58,922 - WARNING - modules.enhanced_markdown_report_generator - Markdown验证失败: expected string or bytes-like object, got 'NoneType'
2025-03-17 11:38:58,923 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown报告保存到: reports\markdown_report_20250317113858.md
2025-03-17 11:38:58,924 - INFO - modules.excel_analyzer - 已将Markdown报告保存到: reports/excel_analysis_report_20250317113858.md
2025-03-17 11:38:58,924 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_113858.md
2025-03-17 11:42:09,503 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 11:42:09,503 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 11:42:09,503 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 11:42:09,504 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 11:42:09,504 - INFO - __main__ - 初始化Excel分析器
2025-03-17 11:42:09,504 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 11:42:09,504 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 11:42:09,504 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 11:42:09,504 - INFO - modules.analysis_dispatcher - 成功初始化 2 个分析单元
2025-03-17 11:42:09,504 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 11:42:09,504 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 11:42:09,505 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 11:42:09,505 - INFO - modules.analysis_dispatcher - 成功初始化 2 个分析单元
2025-03-17 11:42:09,505 - INFO - __main__ - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 11:42:09,505 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 11:42:09,505 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 11:42:10,399 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317114210.csv
2025-03-17 11:42:10,399 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317114210.csv
2025-03-17 11:42:10,440 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 11:42:10,441 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 11:42:10,441 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 11:42:10,442 - INFO - modules.analysis_dispatcher - 执行分析单元 1/2: 总体数据统计分析单元
2025-03-17 11:42:10,442 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 11:42:10,442 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 11:42:10,443 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 11:42:10,443 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 11:42:14,075 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 11:42:14,076 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 11:43:12,926 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 11:43:12,928 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 11:43:12,928 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 11:43:12,928 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 11:43:12,928 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 11:43:12,929 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 11:43:14,937 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 11:43:14,937 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 11:43:14,938 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 11:43:14,939 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 11:43:14,939 - INFO - modules.analysis_dispatcher - 执行分析单元 2/2: 柱状图对比分析单元
2025-03-17 11:43:14,939 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 正在生成数据分析代码...
2025-03-17 11:43:14,939 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 11:43:14,940 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 11:43:14,940 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 11:43:18,955 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 11:43:18,956 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 11:44:12,152 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 11:44:12,153 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功从Python代码块中提取代码
2025-03-17 11:44:12,153 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功生成数据分析代码
2025-03-17 11:44:12,154 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 开始执行并尝试修复代码...
2025-03-17 11:44:12,154 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 执行代码尝试 1/3
2025-03-17 11:44:12,154 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 在沙箱环境中执行代码...
2025-03-17 11:44:13,388 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功
2025-03-17 11:44:13,388 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功（尝试 1/3）
2025-03-17 11:44:13,389 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_柱状图对比分析单元_conclusion.txt
2025-03-17 11:44:13,390 - INFO - modules.analysis_dispatcher - 分析单元 柱状图对比分析单元 执行成功
2025-03-17 11:44:13,392 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_114210
2025-03-17 11:44:13,392 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 2/2
2025-03-17 11:44:13,392 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 11:44:13,392 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 11:44:13,393 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成HTML报告...
2025-03-17 11:44:13,393 - INFO - modules.enhanced_markdown_report_generator - 已将HTML报告保存到: reports\html_report_20250317114413.html
2025-03-17 11:44:13,393 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 11:44:13,393 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 11:44:13,394 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 11:44:17,843 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 11:44:17,844 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 11:44:19,478 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 11:44:19,481 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown报告保存到: reports\markdown_report_20250317114419.md
2025-03-17 11:44:19,481 - INFO - modules.excel_analyzer - 已将Markdown报告保存到: reports/excel_analysis_report_20250317114419.md
2025-03-17 11:44:19,482 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_114419.md
2025-03-17 12:06:22,373 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 12:06:22,373 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 12:06:22,373 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 12:06:22,374 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 12:06:22,374 - INFO - __main__ - 初始化Excel分析器
2025-03-17 12:06:22,374 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 12:06:22,374 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 12:06:22,374 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 12:06:22,374 - INFO - modules.analysis_dispatcher - 成功初始化 2 个分析单元
2025-03-17 12:06:22,375 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 12:06:22,375 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 12:06:22,375 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 12:06:22,375 - INFO - modules.analysis_dispatcher - 成功初始化 2 个分析单元
2025-03-17 12:06:22,375 - INFO - __main__ - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 12:06:22,375 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 12:06:22,375 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 12:06:23,245 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317120623.csv
2025-03-17 12:06:23,245 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317120623.csv
2025-03-17 12:06:23,287 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 12:06:23,288 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 12:06:23,288 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 12:06:23,290 - INFO - modules.analysis_dispatcher - 执行分析单元 1/2: 总体数据统计分析单元
2025-03-17 12:06:23,290 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 12:06:23,290 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 12:06:23,290 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:06:23,290 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:06:28,199 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:06:28,199 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:07:37,443 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:07:37,445 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 12:07:37,445 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 12:07:37,445 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 12:07:37,445 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 12:07:37,446 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 12:07:39,237 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 12:07:39,237 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 12:07:39,238 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 12:07:39,239 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 12:07:39,239 - INFO - modules.analysis_dispatcher - 执行分析单元 2/2: 柱状图对比分析单元
2025-03-17 12:07:39,239 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 正在生成数据分析代码...
2025-03-17 12:07:39,239 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 12:07:39,240 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:07:39,240 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:07:59,694 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:07:59,694 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:08:39,849 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:08:39,850 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功从Python代码块中提取代码
2025-03-17 12:08:39,850 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功生成数据分析代码
2025-03-17 12:08:39,850 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 开始执行并尝试修复代码...
2025-03-17 12:08:39,851 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 执行代码尝试 1/3
2025-03-17 12:08:39,851 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 在沙箱环境中执行代码...
2025-03-17 12:08:41,595 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功
2025-03-17 12:08:41,596 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功（尝试 1/3）
2025-03-17 12:08:41,597 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_柱状图对比分析单元_conclusion.txt
2025-03-17 12:08:41,599 - INFO - modules.analysis_dispatcher - 分析单元 柱状图对比分析单元 执行成功
2025-03-17 12:08:41,600 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_120623
2025-03-17 12:08:41,601 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 2/2
2025-03-17 12:08:41,601 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 12:08:41,601 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 12:08:41,601 - ERROR - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告时出错: 'str' object has no attribute 'items'
2025-03-17 12:08:41,602 - ERROR - modules.excel_analyzer - 分析Excel文件时出错: write() argument must be str, not None
2025-03-17 12:08:41,602 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_120841.md
2025-03-17 12:31:18,196 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 12:31:18,196 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 12:31:18,197 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 12:31:18,197 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 12:31:18,197 - INFO - __main__ - 初始化Excel分析器
2025-03-17 12:31:18,197 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 12:31:18,197 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 12:31:18,198 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 12:31:18,198 - INFO - modules.analysis_dispatcher - 成功初始化 2 个分析单元
2025-03-17 12:31:18,198 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 12:31:18,198 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 12:31:18,198 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 12:31:18,198 - INFO - modules.analysis_dispatcher - 成功初始化 2 个分析单元
2025-03-17 12:31:18,198 - INFO - __main__ - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 12:31:18,199 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 12:31:18,199 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 12:31:19,083 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317123118.csv
2025-03-17 12:31:19,084 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317123118.csv
2025-03-17 12:31:19,127 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 12:31:19,128 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 12:31:19,128 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 12:31:19,129 - INFO - modules.analysis_dispatcher - 执行分析单元 1/2: 总体数据统计分析单元
2025-03-17 12:31:19,129 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 12:31:19,130 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 12:31:19,130 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:31:19,130 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:31:28,907 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:31:28,907 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:31:41,266 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:31:41,268 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 从不完整的Python代码块中提取代码
2025-03-17 12:31:41,268 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 12:31:41,268 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 12:31:41,269 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 12:31:41,269 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 12:31:43,550 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 12:31:43,551 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 12:31:43,551 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 12:31:43,553 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 12:31:43,553 - INFO - modules.analysis_dispatcher - 执行分析单元 2/2: 柱状图对比分析单元
2025-03-17 12:31:43,553 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 正在生成数据分析代码...
2025-03-17 12:31:43,554 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 12:31:43,554 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:31:43,554 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:31:48,757 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:31:48,760 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:32:01,041 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:32:01,042 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 从不完整的Python代码块中提取代码
2025-03-17 12:32:01,042 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功生成数据分析代码
2025-03-17 12:32:01,042 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 开始执行并尝试修复代码...
2025-03-17 12:32:01,044 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 执行代码尝试 1/3
2025-03-17 12:32:01,044 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 在沙箱环境中执行代码...
2025-03-17 12:32:01,680 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功
2025-03-17 12:32:01,681 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行失败，尝试修复（尝试 1/3）
2025-03-17 12:32:01,681 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 正在修复数据分析代码...
2025-03-17 12:32:01,681 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 尝试调用API修复代码（流式输出）...
2025-03-17 12:32:01,682 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:32:01,682 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:32:04,285 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:32:04,286 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:32:31,522 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:32:31,526 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功从Python代码块中提取代码
2025-03-17 12:32:31,527 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功修复数据分析代码
2025-03-17 12:32:31,528 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 执行代码尝试 2/3
2025-03-17 12:32:31,530 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 在沙箱环境中执行代码...
2025-03-17 12:32:32,830 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功
2025-03-17 12:32:32,830 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功（尝试 2/3）
2025-03-17 12:32:32,831 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_柱状图对比分析单元_conclusion.txt
2025-03-17 12:32:32,832 - INFO - modules.analysis_dispatcher - 分析单元 柱状图对比分析单元 执行成功
2025-03-17 12:32:32,834 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_123119
2025-03-17 12:32:32,834 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 2/2
2025-03-17 12:32:32,834 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 12:32:32,834 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 12:32:32,835 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 12:32:32,835 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:32:32,835 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:32:38,666 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:32:38,669 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:33:54,889 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:33:54,897 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown报告保存到: reports\excel_analysis_report_20250317_123354.md
2025-03-17 12:33:54,942 - ERROR - modules.enhanced_markdown_report_generator - 转换Markdown为HTML时出错: Traceback (most recent call last):
  File "D:\smolagent\markdown_to_html.py", line 14, in <module>
    import markdown
ModuleNotFoundError: No module named 'markdown'

2025-03-17 12:33:54,943 - ERROR - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告时出错: write() argument must be str, not None
2025-03-17 12:33:54,944 - ERROR - modules.enhanced_markdown_report_generator - Traceback (most recent call last):
  File "D:\smolagent\modules\enhanced_markdown_report_generator.py", line 490, in generate_markdown_report
    f.write(html_content)
    ~~~~~~~^^^^^^^^^^^^^^
TypeError: write() argument must be str, not None

2025-03-17 12:33:54,945 - ERROR - modules.excel_analyzer - 生成Markdown报告失败
2025-03-17 12:33:54,946 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_123354.md
2025-03-17 12:35:16,581 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 12:35:16,581 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 12:35:16,581 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 12:35:16,581 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 12:35:16,581 - INFO - __main__ - 初始化Excel分析器
2025-03-17 12:35:16,582 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 12:35:16,582 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 12:35:16,582 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 12:35:16,582 - INFO - modules.analysis_dispatcher - 成功初始化 2 个分析单元
2025-03-17 12:35:16,582 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 12:35:16,582 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 12:35:16,582 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 12:35:16,583 - INFO - modules.analysis_dispatcher - 成功初始化 2 个分析单元
2025-03-17 12:35:16,583 - INFO - __main__ - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 12:35:16,583 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 12:35:16,583 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 12:35:17,457 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317123517.csv
2025-03-17 12:35:17,457 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317123517.csv
2025-03-17 12:35:17,500 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 12:35:17,500 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 12:35:17,500 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 12:35:17,501 - INFO - modules.analysis_dispatcher - 执行分析单元 1/2: 总体数据统计分析单元
2025-03-17 12:35:17,501 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 12:35:17,501 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 12:35:17,502 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:35:17,502 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:35:21,124 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:35:21,125 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:35:51,434 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:35:51,435 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 12:35:51,435 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 12:35:51,436 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 12:35:51,436 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 12:35:51,436 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 12:35:51,476 - WARNING - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行失败，错误码: 1
2025-03-17 12:35:51,477 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行失败，尝试修复（尝试 1/3）
2025-03-17 12:35:51,477 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在修复数据分析代码...
2025-03-17 12:35:51,477 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API修复代码（流式输出）...
2025-03-17 12:35:51,477 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:35:51,477 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:35:56,806 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:35:56,808 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:36:23,523 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:36:23,524 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 12:36:23,525 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功修复数据分析代码
2025-03-17 12:36:23,525 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 2/3
2025-03-17 12:36:23,525 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 12:36:24,942 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 12:36:24,942 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 2/3）
2025-03-17 12:36:24,943 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 12:36:24,944 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 12:36:24,944 - INFO - modules.analysis_dispatcher - 执行分析单元 2/2: 柱状图对比分析单元
2025-03-17 12:36:24,945 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 正在生成数据分析代码...
2025-03-17 12:36:24,945 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 12:36:24,945 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:36:24,945 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:36:28,392 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:36:28,393 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:37:27,928 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:37:27,929 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功从Python代码块中提取代码
2025-03-17 12:37:27,929 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功生成数据分析代码
2025-03-17 12:37:27,929 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 开始执行并尝试修复代码...
2025-03-17 12:37:27,930 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 执行代码尝试 1/3
2025-03-17 12:37:27,930 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 在沙箱环境中执行代码...
2025-03-17 12:37:29,161 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功
2025-03-17 12:37:29,161 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功（尝试 1/3）
2025-03-17 12:37:29,162 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_柱状图对比分析单元_conclusion.txt
2025-03-17 12:37:29,163 - INFO - modules.analysis_dispatcher - 分析单元 柱状图对比分析单元 执行成功
2025-03-17 12:37:29,165 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_123517
2025-03-17 12:37:29,165 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 2/2
2025-03-17 12:37:29,166 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 12:37:29,166 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 12:37:29,166 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 12:37:29,166 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:37:29,166 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:37:32,418 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:37:32,421 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:38:43,038 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:38:43,047 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown报告保存到: reports\excel_analysis_report_20250317_123843.md
2025-03-17 12:38:43,090 - ERROR - modules.enhanced_markdown_report_generator - 转换Markdown为HTML时出错: Traceback (most recent call last):
  File "D:\smolagent\markdown_to_html.py", line 14, in <module>
    import markdown
ModuleNotFoundError: No module named 'markdown'

2025-03-17 12:38:43,129 - INFO - modules.enhanced_markdown_report_generator - 已将HTML报告保存到: reports\html_report_20250317_123843.html
2025-03-17 12:38:43,200 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\html_report_20250317_123843.html
2025-03-17 12:38:43,205 - INFO - modules.excel_analyzer - 已自动打开Markdown报告: reports/excel_analysis_report_20250317_123843.md
2025-03-17 12:38:43,206 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_123843.md
2025-03-17 12:40:37,613 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 12:40:37,613 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 12:40:37,613 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 12:40:37,614 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 12:40:37,614 - INFO - __main__ - 初始化Excel分析器
2025-03-17 12:40:37,614 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 12:40:37,614 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 12:40:37,614 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 12:40:37,614 - INFO - modules.analysis_dispatcher - 成功初始化 2 个分析单元
2025-03-17 12:40:37,615 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 12:40:37,615 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 12:40:37,615 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 12:40:37,615 - INFO - modules.analysis_dispatcher - 成功初始化 2 个分析单元
2025-03-17 12:40:37,615 - INFO - __main__ - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 12:40:37,615 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 12:40:37,615 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 12:40:38,523 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317124038.csv
2025-03-17 12:40:38,523 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317124038.csv
2025-03-17 12:40:38,562 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 12:40:38,562 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 12:40:38,562 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 12:40:38,563 - INFO - modules.analysis_dispatcher - 执行分析单元 1/2: 总体数据统计分析单元
2025-03-17 12:40:38,563 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 12:40:38,564 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 12:40:38,564 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:40:38,564 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:40:43,753 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:40:43,754 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:41:47,486 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:41:47,487 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 12:41:47,487 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 12:41:47,488 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 12:41:47,488 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 12:41:47,488 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 12:41:50,118 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 12:41:50,118 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 12:41:50,119 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 12:41:50,120 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 12:41:50,120 - INFO - modules.analysis_dispatcher - 执行分析单元 2/2: 柱状图对比分析单元
2025-03-17 12:41:50,120 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 正在生成数据分析代码...
2025-03-17 12:41:50,121 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 12:41:50,121 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:41:50,121 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:41:53,809 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:41:53,811 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:42:47,189 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:42:47,190 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功从Python代码块中提取代码
2025-03-17 12:42:47,191 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功生成数据分析代码
2025-03-17 12:42:47,191 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 开始执行并尝试修复代码...
2025-03-17 12:42:47,191 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 执行代码尝试 1/3
2025-03-17 12:42:47,191 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 在沙箱环境中执行代码...
2025-03-17 12:42:48,734 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功
2025-03-17 12:42:48,735 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功（尝试 1/3）
2025-03-17 12:42:48,736 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_柱状图对比分析单元_conclusion.txt
2025-03-17 12:42:48,737 - INFO - modules.analysis_dispatcher - 分析单元 柱状图对比分析单元 执行成功
2025-03-17 12:42:48,738 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_124038
2025-03-17 12:42:48,739 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 2/2
2025-03-17 12:42:48,739 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 12:42:48,739 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 12:42:48,739 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 12:42:48,739 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:42:48,740 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:42:52,939 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:42:52,942 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:44:24,943 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:44:24,951 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown报告保存到: reports\excel_analysis_report_20250317_124424.md
2025-03-17 12:44:24,987 - INFO - modules.enhanced_markdown_report_generator - 已将HTML报告保存到: reports\html_report_20250317_124424.html
2025-03-17 12:44:25,060 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\html_report_20250317_124424.html
2025-03-17 12:44:25,064 - INFO - modules.excel_analyzer - 已自动打开Markdown报告: reports/excel_analysis_report_20250317_124425.md
2025-03-17 12:44:25,065 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_124425.md
2025-03-17 12:47:10,503 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 12:47:10,503 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 12:47:10,504 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 12:47:10,504 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 12:47:10,504 - INFO - __main__ - 初始化Excel分析器
2025-03-17 12:47:10,504 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 12:47:10,504 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 12:47:10,505 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 12:47:10,505 - INFO - modules.analysis_dispatcher - 成功初始化 2 个分析单元
2025-03-17 12:47:10,505 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 12:47:10,505 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 12:47:10,505 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 12:47:10,505 - INFO - modules.analysis_dispatcher - 成功初始化 2 个分析单元
2025-03-17 12:47:10,505 - INFO - __main__ - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 12:47:10,506 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 12:47:10,506 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 12:47:12,779 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317124712.csv
2025-03-17 12:47:12,780 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317124712.csv
2025-03-17 12:47:12,858 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 12:47:12,859 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 12:47:12,859 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 12:47:12,860 - INFO - modules.analysis_dispatcher - 执行分析单元 1/2: 总体数据统计分析单元
2025-03-17 12:47:12,861 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 12:47:12,861 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 12:47:12,861 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:47:12,861 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:47:17,102 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:47:17,104 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:48:14,900 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:48:14,908 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 12:48:14,909 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 12:48:14,910 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 12:48:14,912 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 12:48:14,913 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 12:48:16,851 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 12:48:16,852 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 12:48:16,853 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 12:48:16,853 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 12:48:16,853 - INFO - modules.analysis_dispatcher - 执行分析单元 2/2: 柱状图对比分析单元
2025-03-17 12:48:16,853 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 正在生成数据分析代码...
2025-03-17 12:48:16,853 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 12:48:16,854 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:48:16,854 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:48:22,424 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:48:22,427 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:48:34,666 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:48:34,669 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 从不完整的Python代码块中提取代码
2025-03-17 12:48:34,670 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功生成数据分析代码
2025-03-17 12:48:34,670 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 开始执行并尝试修复代码...
2025-03-17 12:48:34,674 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 执行代码尝试 1/3
2025-03-17 12:48:34,676 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 在沙箱环境中执行代码...
2025-03-17 12:48:34,720 - WARNING - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行失败，错误码: 1
2025-03-17 12:48:34,720 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行失败，尝试修复（尝试 1/3）
2025-03-17 12:48:34,720 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 正在修复数据分析代码...
2025-03-17 12:48:34,720 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 尝试调用API修复代码（流式输出）...
2025-03-17 12:48:34,721 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:48:34,721 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:48:39,569 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:48:39,571 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:49:02,202 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:49:02,208 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功从Python代码块中提取代码
2025-03-17 12:49:02,209 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 成功修复数据分析代码
2025-03-17 12:49:02,211 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 执行代码尝试 2/3
2025-03-17 12:49:02,213 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 在沙箱环境中执行代码...
2025-03-17 12:49:03,392 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功
2025-03-17 12:49:03,393 - INFO - modules.analysis_units.base_analysis_unit - [柱状图对比分析单元] 代码执行成功（尝试 2/3）
2025-03-17 12:49:03,394 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_柱状图对比分析单元_conclusion.txt
2025-03-17 12:49:03,394 - INFO - modules.analysis_dispatcher - 分析单元 柱状图对比分析单元 执行成功
2025-03-17 12:49:03,395 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_124712
2025-03-17 12:49:03,395 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 2/2
2025-03-17 12:49:03,395 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 12:49:03,395 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 12:49:03,395 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 12:49:03,396 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:49:03,396 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:49:06,859 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:49:06,860 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:49:27,562 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:49:27,571 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown报告保存到: reports\excel_analysis_report_20250317_124927.md
2025-03-17 12:49:27,606 - INFO - modules.enhanced_markdown_report_generator - 已将HTML报告保存到: reports\html_report_20250317_124927.html
2025-03-17 12:49:27,674 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\html_report_20250317_124927.html
2025-03-17 12:49:27,680 - INFO - modules.excel_analyzer - 已自动打开Markdown报告: reports/excel_analysis_report_20250317_124927.md
2025-03-17 12:49:27,681 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_124927.md
2025-03-17 12:55:02,978 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 12:55:02,979 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 12:55:02,979 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 12:55:02,979 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 12:55:02,979 - INFO - __main__ - 初始化Excel分析器
2025-03-17 12:55:02,979 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 12:55:02,979 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 12:55:02,979 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 12:55:02,980 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 12:55:02,980 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 12:55:02,980 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 12:55:02,980 - INFO - __main__ - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 12:55:02,981 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 12:55:02,981 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 12:55:05,300 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317125505.csv
2025-03-17 12:55:05,301 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317125505.csv
2025-03-17 12:55:05,390 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 12:55:05,391 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 12:55:05,391 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 12:55:05,392 - INFO - modules.analysis_dispatcher - 执行分析单元 1/1: 总体数据统计分析单元
2025-03-17 12:55:05,392 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 12:55:05,393 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 12:55:05,393 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:55:05,393 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:55:08,598 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:55:08,600 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:56:10,574 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:56:10,576 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 12:56:10,576 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 12:56:10,576 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 12:56:10,577 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 12:56:10,577 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 12:56:12,514 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 12:56:12,515 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 12:56:12,516 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 12:56:12,516 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 12:56:12,517 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_125505
2025-03-17 12:56:12,517 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 1/1
2025-03-17 12:56:12,517 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 12:56:12,517 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 12:56:12,517 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 12:56:12,518 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:56:12,518 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:56:16,966 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:56:16,969 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:56:48,107 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:56:48,110 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown报告保存到: reports\excel_analysis_report_20250317_125648.md
2025-03-17 12:56:48,143 - INFO - modules.enhanced_markdown_report_generator - 已将HTML报告保存到: reports\html_report_20250317_125648.html
2025-03-17 12:56:48,217 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\html_report_20250317_125648.html
2025-03-17 12:56:48,222 - INFO - modules.excel_analyzer - 已自动打开Markdown报告: reports/excel_analysis_report_20250317_125648.md
2025-03-17 12:56:48,223 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_125648.md
2025-03-17 12:58:16,482 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 12:58:16,482 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 12:58:16,483 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 12:58:16,483 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 12:58:16,483 - INFO - __main__ - 初始化Excel分析器
2025-03-17 12:58:16,483 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 12:58:16,483 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 12:58:16,483 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 12:58:16,483 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 12:58:16,483 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 12:58:16,484 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 12:58:16,484 - INFO - __main__ - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 12:58:16,484 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 12:58:16,484 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 12:58:18,769 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317125818.csv
2025-03-17 12:58:18,770 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317125818.csv
2025-03-17 12:58:18,849 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 12:58:18,850 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 12:58:18,850 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 12:58:18,852 - INFO - modules.analysis_dispatcher - 执行分析单元 1/1: 总体数据统计分析单元
2025-03-17 12:58:18,852 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 12:58:18,852 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 12:58:18,853 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:58:18,853 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:58:39,890 - ERROR - modules.model_connector - API流式请求异常 (尝试 1/3): HTTPSConnectionPool(host='xiaohumini.site', port=443): Max retries exceeded with url: /v1/chat/completions (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x000001A919DC46E0>, 'Connection to xiaohumini.site timed out. (connect timeout=60)'))
2025-03-17 12:58:39,893 - INFO - modules.model_connector - 2秒后重试...
2025-03-17 12:58:41,895 - INFO - modules.model_connector - 尝试流式调用API (尝试 2/3)...
2025-03-17 12:58:41,896 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:58:44,961 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:58:44,965 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:59:39,066 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:59:39,067 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 12:59:39,067 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 12:59:39,067 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 12:59:39,068 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 12:59:39,068 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 12:59:41,301 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 12:59:41,301 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 12:59:41,302 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 12:59:41,302 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 12:59:41,303 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_125818
2025-03-17 12:59:41,304 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 1/1
2025-03-17 12:59:41,304 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 12:59:41,304 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 12:59:41,304 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 12:59:41,304 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 12:59:41,304 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 12:59:47,252 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 12:59:47,252 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 12:59:59,641 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 12:59:59,647 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown报告保存到: reports\excel_analysis_report_20250317_125959.md
2025-03-17 12:59:59,679 - INFO - modules.enhanced_markdown_report_generator - 已将HTML报告保存到: reports\html_report_20250317_125959.html
2025-03-17 12:59:59,746 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\html_report_20250317_125959.html
2025-03-17 12:59:59,753 - INFO - modules.excel_analyzer - 已自动打开Markdown报告: reports/excel_analysis_report_20250317_125959.md
2025-03-17 12:59:59,753 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_125959.md
2025-03-17 13:10:26,376 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 13:10:26,376 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 13:10:26,377 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 13:10:26,377 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 13:10:26,377 - INFO - __main__ - 初始化Excel分析器
2025-03-17 13:10:26,377 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 13:10:26,377 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 13:10:26,377 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 13:10:26,377 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 13:10:26,378 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 13:10:26,378 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 13:10:26,378 - INFO - __main__ - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:10:26,378 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:10:26,378 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:10:28,778 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317131028.csv
2025-03-17 13:10:28,778 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317131028.csv
2025-03-17 13:10:28,860 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 13:10:28,861 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 13:10:28,861 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 13:10:28,862 - INFO - modules.analysis_dispatcher - 执行分析单元 1/1: 总体数据统计分析单元
2025-03-17 13:10:28,862 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 13:10:28,863 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 13:10:28,863 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 13:10:28,863 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 13:10:32,036 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 13:10:32,036 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 13:10:52,313 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 13:10:52,314 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 13:10:52,315 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 13:10:52,315 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 13:10:52,315 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 13:10:52,315 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 13:10:52,807 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 13:10:52,807 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 13:10:52,808 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 13:10:52,808 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 13:10:52,810 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_131028
2025-03-17 13:10:52,810 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 1/1
2025-03-17 13:10:52,810 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 13:10:52,810 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 13:10:52,810 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 13:10:52,811 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 13:10:52,811 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 13:10:56,613 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 13:10:56,614 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 13:11:05,328 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 13:11:05,331 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown报告保存到: reports\excel_analysis_report_20250317_131105.md
2025-03-17 13:11:05,364 - INFO - modules.enhanced_markdown_report_generator - 已将HTML报告保存到: reports\html_report_20250317_131105.html
2025-03-17 13:11:05,436 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\html_report_20250317_131105.html
2025-03-17 13:11:05,442 - INFO - modules.excel_analyzer - 已自动打开Markdown报告: reports/excel_analysis_report_20250317_131105.md
2025-03-17 13:11:05,443 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_131105.md
2025-03-17 13:13:03,198 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 13:13:03,198 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 13:13:03,198 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 13:13:03,198 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 13:13:03,198 - INFO - __main__ - 初始化Excel分析器
2025-03-17 13:13:03,199 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 13:13:03,199 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 13:13:03,199 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 13:13:03,199 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 13:13:03,199 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 13:13:03,199 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 13:13:03,199 - INFO - __main__ - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:13:03,200 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:13:03,200 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:13:05,598 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317131305.csv
2025-03-17 13:13:05,598 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317131305.csv
2025-03-17 13:13:05,680 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 13:13:05,681 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 13:13:05,681 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 13:13:05,682 - INFO - modules.analysis_dispatcher - 执行分析单元 1/1: 总体数据统计分析单元
2025-03-17 13:13:05,682 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 13:13:05,682 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 13:13:05,683 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 13:13:05,683 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 13:13:09,576 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 13:13:09,576 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 13:13:31,066 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 13:13:31,067 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 13:13:31,068 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 13:13:31,068 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 13:13:31,069 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 13:13:31,069 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 13:13:31,555 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 13:13:31,556 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 13:13:31,556 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 13:13:31,556 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 13:13:31,558 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_131305
2025-03-17 13:13:31,558 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 1/1
2025-03-17 13:13:31,558 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 13:13:31,558 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 13:13:31,558 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 13:13:31,558 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 13:13:31,559 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 13:13:34,994 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 13:13:34,995 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 13:13:56,877 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 13:13:56,880 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown报告保存到: reports\excel_analysis_report_20250317_131356.md
2025-03-17 13:13:56,911 - INFO - modules.enhanced_markdown_report_generator - 已将HTML报告保存到: reports\html_report_20250317_131356.html
2025-03-17 13:13:56,982 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\html_report_20250317_131356.html
2025-03-17 13:13:56,989 - INFO - modules.excel_analyzer - 已自动打开Markdown报告: reports/excel_analysis_report_20250317_131356.md
2025-03-17 13:13:56,989 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_131356.md
2025-03-17 13:23:19,736 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 13:23:19,736 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 13:23:19,736 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 13:23:19,736 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 13:23:19,737 - INFO - __main__ - 初始化Excel分析器
2025-03-17 13:23:19,737 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 13:23:19,737 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 13:23:19,737 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 13:23:19,737 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 13:23:19,737 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 13:23:19,737 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 13:23:19,737 - INFO - __main__ - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:23:19,738 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:23:19,738 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:23:22,054 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317132321.csv
2025-03-17 13:23:22,054 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317132321.csv
2025-03-17 13:23:22,142 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 13:23:22,143 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 13:23:22,144 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 13:23:22,145 - INFO - modules.analysis_dispatcher - 执行分析单元 1/1: 总体数据统计分析单元
2025-03-17 13:23:22,145 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 13:23:22,146 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 13:23:22,146 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 13:23:22,146 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 13:23:27,505 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 13:23:27,506 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 13:23:39,552 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 13:23:39,553 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 13:23:39,553 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 13:23:39,553 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 13:23:39,554 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 13:23:39,554 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 13:23:40,032 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 13:23:40,033 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 13:23:40,033 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 13:23:40,034 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 13:23:40,035 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_132322
2025-03-17 13:23:40,035 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 1/1
2025-03-17 13:23:40,035 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 13:23:40,035 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 13:23:40,035 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 13:23:40,036 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 13:23:40,036 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 13:23:43,389 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 13:23:43,389 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 13:24:00,633 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 13:24:00,638 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown报告保存到: reports\excel_analysis_report_20250317_132400.md
2025-03-17 13:24:00,673 - INFO - modules.enhanced_markdown_report_generator - 已将HTML报告保存到: reports\html_report_20250317_132400.html
2025-03-17 13:24:00,748 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\html_report_20250317_132400.html
2025-03-17 13:24:00,754 - INFO - modules.excel_analyzer - 已自动打开Markdown报告: reports/excel_analysis_report_20250317_132400.md
2025-03-17 13:24:00,755 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_132400.md
2025-03-17 13:28:09,491 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 13:28:09,491 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 13:28:09,491 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 13:28:09,492 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 13:28:09,492 - INFO - __main__ - 初始化Excel分析器
2025-03-17 13:28:09,492 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 13:28:09,492 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 13:28:09,492 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 13:28:09,493 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 13:28:09,493 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 13:28:09,493 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 13:28:09,493 - INFO - __main__ - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:28:09,493 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:28:09,493 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:28:12,041 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317132811.csv
2025-03-17 13:28:12,042 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317132811.csv
2025-03-17 13:28:12,135 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 13:28:12,136 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 13:28:12,136 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 13:28:12,138 - INFO - modules.analysis_dispatcher - 执行分析单元 1/1: 总体数据统计分析单元
2025-03-17 13:28:12,138 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 13:28:12,138 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 13:28:12,139 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 13:28:12,139 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 13:28:15,918 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 13:28:15,920 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 13:28:37,683 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 13:28:37,684 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 13:28:37,685 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 13:28:37,685 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 13:28:37,685 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 13:28:37,686 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 13:28:38,184 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 13:28:38,185 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 13:28:38,185 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 13:28:38,185 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 13:28:38,187 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_132812
2025-03-17 13:28:38,187 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 1/1
2025-03-17 13:28:38,187 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 13:28:38,187 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 13:28:38,187 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 13:28:38,188 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 13:28:38,188 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 13:28:41,858 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 13:28:41,859 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 13:28:58,325 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 13:28:58,328 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown报告保存到: reports\excel_analysis_report_20250317_132858.md
2025-03-17 13:28:58,363 - INFO - modules.enhanced_markdown_report_generator - 已将HTML报告保存到: reports\html_report_20250317_132858.html
2025-03-17 13:28:58,431 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\html_report_20250317_132858.html
2025-03-17 13:28:58,437 - INFO - modules.excel_analyzer - 已自动打开Markdown报告: reports/excel_analysis_report_20250317_132858.md
2025-03-17 13:28:58,437 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_132858.md
2025-03-17 13:38:45,530 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 13:38:45,530 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 13:38:45,530 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 13:38:45,530 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 13:38:45,531 - INFO - __main__ - 初始化Excel分析器
2025-03-17 13:38:45,531 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 13:38:45,531 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 13:38:45,531 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 13:38:45,531 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 13:38:45,532 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 13:38:45,532 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 13:38:45,532 - INFO - __main__ - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:38:45,532 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:38:45,532 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:38:47,893 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317133847.csv
2025-03-17 13:38:47,894 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317133847.csv
2025-03-17 13:38:47,976 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 13:38:47,977 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 13:38:47,977 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 13:38:47,979 - INFO - modules.analysis_dispatcher - 执行分析单元 1/1: 总体数据统计分析单元
2025-03-17 13:38:47,980 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 13:38:47,980 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 13:38:47,980 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 13:38:47,981 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 13:39:32,496 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 13:39:32,496 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 13:40:43,285 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 13:40:43,287 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 13:40:43,287 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 13:40:43,287 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 13:40:43,287 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 13:40:43,288 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 13:40:43,748 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 13:40:43,749 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 13:40:43,749 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 13:40:43,750 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 13:40:43,751 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_133847
2025-03-17 13:40:43,752 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 1/1
2025-03-17 13:40:43,752 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 13:40:43,752 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 13:40:43,752 - ERROR - modules.enhanced_markdown_report_generator - 生成Markdown报告时出错: 'str' object has no attribute 'items'
2025-03-17 13:40:43,794 - INFO - modules.excel_analyzer - 已自动打开Markdown报告: reports/excel_analysis_report_20250317_134043.md
2025-03-17 13:40:43,795 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_134043.md
2025-03-17 13:42:02,344 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 13:42:02,344 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 13:42:02,345 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 13:42:02,345 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 13:42:02,345 - INFO - __main__ - 初始化Excel分析器
2025-03-17 13:42:02,345 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 13:42:02,345 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 13:42:02,345 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 13:42:02,346 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 13:42:02,346 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 13:42:02,346 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 13:42:02,346 - INFO - __main__ - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:42:02,346 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:42:02,346 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:42:04,665 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317134204.csv
2025-03-17 13:42:04,666 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317134204.csv
2025-03-17 13:42:04,746 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 13:42:04,747 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 13:42:04,747 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 13:42:04,749 - INFO - modules.analysis_dispatcher - 执行分析单元 1/1: 总体数据统计分析单元
2025-03-17 13:42:04,749 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 13:42:04,749 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 13:42:04,749 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 13:42:04,749 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 13:42:09,823 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 13:42:09,825 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 13:43:08,430 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 13:43:08,431 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 13:43:08,431 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 13:43:08,431 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 13:43:08,432 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 13:43:08,432 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 13:43:08,875 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 13:43:08,875 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 13:43:08,876 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 13:43:08,877 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 13:43:08,878 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_134204
2025-03-17 13:43:08,879 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 1/1
2025-03-17 13:43:08,879 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 13:43:08,879 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 13:43:08,879 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 13:43:08,879 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 13:43:08,879 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 13:43:08,879 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 13:43:19,758 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 13:43:19,759 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 13:43:33,066 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 13:43:33,108 - INFO - modules.excel_analyzer - 已自动打开Markdown报告: reports/excel_analysis_report_20250317_134333.md
2025-03-17 13:43:33,110 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_134333.md
2025-03-17 13:51:39,396 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 13:51:39,396 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 13:51:39,396 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 13:51:39,396 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 13:51:39,396 - INFO - __main__ - 初始化Excel分析器
2025-03-17 13:51:39,397 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 13:51:39,397 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 13:51:39,397 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 13:51:39,397 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 13:51:39,397 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 13:51:39,397 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 13:51:39,397 - INFO - __main__ - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:51:39,397 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:51:39,398 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:51:41,727 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317135141.csv
2025-03-17 13:51:41,728 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317135141.csv
2025-03-17 13:51:41,814 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 13:51:41,814 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 13:51:41,814 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 13:51:41,816 - INFO - modules.analysis_dispatcher - 执行分析单元 1/1: 总体数据统计分析单元
2025-03-17 13:51:41,816 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 13:51:41,816 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 13:51:41,816 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 13:51:41,816 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 13:51:47,901 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 13:51:47,904 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 13:51:59,474 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 13:51:59,475 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 从不完整的Python代码块中提取代码
2025-03-17 13:51:59,475 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 13:51:59,476 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 13:51:59,476 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 13:51:59,476 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 13:51:59,516 - WARNING - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行失败，错误码: 1
2025-03-17 13:51:59,516 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行失败，尝试修复（尝试 1/3）
2025-03-17 13:51:59,517 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在修复数据分析代码...
2025-03-17 13:51:59,517 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API修复代码（流式输出）...
2025-03-17 13:51:59,517 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 13:51:59,517 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 13:52:04,010 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 13:52:04,012 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 13:52:14,068 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 13:52:14,069 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 从不完整的Python代码块中提取代码
2025-03-17 13:52:14,070 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功修复数据分析代码
2025-03-17 13:52:14,070 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 2/3
2025-03-17 13:52:14,070 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 13:52:14,406 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 13:52:14,407 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行失败，尝试修复（尝试 2/3）
2025-03-17 13:52:14,407 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在修复数据分析代码...
2025-03-17 13:52:14,407 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API修复代码（流式输出）...
2025-03-17 13:52:14,407 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 13:52:14,408 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 13:52:18,247 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 13:52:18,249 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 13:52:39,288 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 13:52:39,290 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 13:52:39,290 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功修复数据分析代码
2025-03-17 13:52:39,290 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 3/3
2025-03-17 13:52:39,290 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 13:52:39,761 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 13:52:39,762 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 3/3）
2025-03-17 13:52:39,762 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 13:52:39,763 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 13:52:39,764 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_135141
2025-03-17 13:52:39,765 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 1/1
2025-03-17 13:52:39,765 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 13:52:39,765 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 13:52:39,765 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 13:52:39,765 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 13:52:39,765 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 13:52:39,765 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 13:52:39,765 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 13:52:45,495 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 13:52:45,496 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 13:54:00,603 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 13:54:00,660 - ERROR - modules.enhanced_markdown_report_generator - 渲染Markdown为HTML失败: Traceback (most recent call last):
  File "D:\smolagent\markdown_to_html.py", line 14, in <module>
    import markdown
ModuleNotFoundError: No module named 'markdown'

2025-03-17 13:54:00,752 - INFO - modules.excel_analyzer - 已自动打开Markdown报告: reports/excel_analysis_report_20250317_135400.md
2025-03-17 13:54:00,753 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_135400.md
2025-03-17 13:56:32,083 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 13:56:32,083 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 13:56:32,083 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 13:56:32,083 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 13:56:32,084 - INFO - __main__ - 初始化Excel分析器
2025-03-17 13:56:32,084 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 13:56:32,084 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 13:56:32,084 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 13:56:32,084 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 13:56:32,084 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 13:56:32,084 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 13:56:32,085 - INFO - __main__ - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:56:32,085 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:56:32,085 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 13:56:34,405 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317135634.csv
2025-03-17 13:56:34,406 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317135634.csv
2025-03-17 13:56:34,487 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 13:56:34,488 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 13:56:34,488 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 13:56:34,489 - INFO - modules.analysis_dispatcher - 执行分析单元 1/1: 总体数据统计分析单元
2025-03-17 13:56:34,489 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 13:56:34,489 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 13:56:34,490 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 13:56:34,490 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 13:56:38,610 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 13:56:38,610 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 13:57:32,069 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 13:57:32,071 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 13:57:32,071 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 13:57:32,071 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 13:57:32,072 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 13:57:32,072 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 13:57:32,544 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 13:57:32,545 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 13:57:32,545 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 13:57:32,547 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 13:57:32,548 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_135634
2025-03-17 13:57:32,548 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 1/1
2025-03-17 13:57:32,548 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 13:57:32,548 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 13:57:32,548 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 13:57:32,548 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 13:57:32,549 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 13:57:32,549 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 13:57:32,549 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 13:57:38,458 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 13:57:38,460 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 13:58:55,070 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 13:58:55,079 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports/html_report_20250317_135855.html
2025-03-17 13:58:55,173 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports/html_report_20250317_135855.html
2025-03-17 13:58:55,196 - INFO - modules.excel_analyzer - 已自动打开Markdown报告: reports/excel_analysis_report_20250317_135855.md
2025-03-17 13:58:55,197 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_135855.md
2025-03-17 13:58:55,198 - INFO - __main__ - HTML图表报告已保存到: reports/excel_analysis_report_20250317_135855.html
2025-03-17 14:02:35,835 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 14:02:35,835 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 14:02:35,836 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 14:02:35,836 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 14:02:35,836 - INFO - __main__ - 初始化Excel分析器
2025-03-17 14:02:35,836 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 14:02:35,836 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 14:02:35,836 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 14:02:35,836 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 14:02:35,837 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 14:02:35,837 - INFO - modules.analysis_dispatcher - 已启用相关性分析单元
2025-03-17 14:02:35,837 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 14:02:35,837 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 14:02:35,837 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 14:02:35,837 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 14:02:35,837 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 14:02:35,838 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 14:02:35,838 - INFO - modules.analysis_dispatcher - 已启用相关性分析单元
2025-03-17 14:02:35,838 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 14:02:35,838 - INFO - __main__ - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:02:35,838 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:02:35,838 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:02:38,161 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317140237.csv
2025-03-17 14:02:38,162 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317140237.csv
2025-03-17 14:02:38,246 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 14:02:38,247 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 14:02:38,247 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 14:02:38,249 - INFO - modules.analysis_dispatcher - 执行分析单元 1/5: 总体数据统计分析单元
2025-03-17 14:02:38,249 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 14:02:38,249 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:02:38,250 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:02:38,250 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:02:41,995 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:02:41,997 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:03:35,659 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:03:35,660 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 14:03:35,660 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 14:03:35,661 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 14:03:35,661 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 14:03:35,662 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 14:03:36,166 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 14:03:36,167 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:03:36,167 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 14:03:36,168 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 14:03:36,168 - INFO - modules.analysis_dispatcher - 执行分析单元 2/5: 分组对比分析单元
2025-03-17 14:03:36,169 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 正在生成数据分析代码...
2025-03-17 14:03:36,169 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:03:36,169 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:03:36,169 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:03:43,754 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:03:43,754 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:03:55,470 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:03:55,471 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功从Python代码块中提取代码
2025-03-17 14:03:55,471 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功生成数据分析代码
2025-03-17 14:03:55,471 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 开始执行并尝试修复代码...
2025-03-17 14:03:55,472 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 执行代码尝试 1/3
2025-03-17 14:03:55,472 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 在沙箱环境中执行代码...
2025-03-17 14:03:55,903 - WARNING - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行失败，错误码: 1
2025-03-17 14:03:55,903 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行失败，尝试修复（尝试 1/3）
2025-03-17 14:03:55,903 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 正在修复数据分析代码...
2025-03-17 14:03:55,903 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 尝试调用API修复代码（流式输出）...
2025-03-17 14:03:55,904 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:03:55,904 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:04:00,016 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:04:00,016 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:04:39,426 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:04:39,427 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功从Python代码块中提取代码
2025-03-17 14:04:39,427 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功修复数据分析代码
2025-03-17 14:04:39,427 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 执行代码尝试 2/3
2025-03-17 14:04:39,427 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 在沙箱环境中执行代码...
2025-03-17 14:04:39,860 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行成功
2025-03-17 14:04:39,860 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行成功（尝试 2/3）
2025-03-17 14:04:39,861 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_分组对比分析单元_conclusion.txt
2025-03-17 14:04:39,862 - INFO - modules.analysis_dispatcher - 分析单元 分组对比分析单元 执行成功
2025-03-17 14:04:39,862 - INFO - modules.analysis_dispatcher - 执行分析单元 3/5: 比例分析单元
2025-03-17 14:04:39,862 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 正在生成数据分析代码...
2025-03-17 14:04:39,862 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:04:39,862 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:04:39,862 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:04:45,031 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:04:45,033 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:05:08,018 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:05:08,019 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 成功从Python代码块中提取代码
2025-03-17 14:05:08,019 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 成功生成数据分析代码
2025-03-17 14:05:08,019 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 开始执行并尝试修复代码...
2025-03-17 14:05:08,019 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 执行代码尝试 1/3
2025-03-17 14:05:08,020 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 在沙箱环境中执行代码...
2025-03-17 14:05:08,445 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 代码执行成功
2025-03-17 14:05:08,446 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:05:08,446 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\3_比例分析单元_conclusion.txt
2025-03-17 14:05:08,447 - INFO - modules.analysis_dispatcher - 分析单元 比例分析单元 执行成功
2025-03-17 14:05:08,447 - INFO - modules.analysis_dispatcher - 执行分析单元 4/5: 时间趋势分析单元
2025-03-17 14:05:08,447 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在生成数据分析代码...
2025-03-17 14:05:08,448 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:05:08,448 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:05:08,448 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:05:12,473 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:05:12,477 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:05:38,461 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:05:38,463 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功从Python代码块中提取代码
2025-03-17 14:05:38,464 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功生成数据分析代码
2025-03-17 14:05:38,464 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 开始执行并尝试修复代码...
2025-03-17 14:05:38,465 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 执行代码尝试 1/3
2025-03-17 14:05:38,465 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 在沙箱环境中执行代码...
2025-03-17 14:05:39,467 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功
2025-03-17 14:05:39,467 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:05:39,469 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\4_时间趋势分析单元_conclusion.txt
2025-03-17 14:05:39,469 - INFO - modules.analysis_dispatcher - 分析单元 时间趋势分析单元 执行成功
2025-03-17 14:05:39,469 - INFO - modules.analysis_dispatcher - 执行分析单元 5/5: 相关性分析单元
2025-03-17 14:05:39,470 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 正在生成数据分析代码...
2025-03-17 14:05:39,470 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:05:39,470 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:05:39,470 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:05:43,364 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:05:43,366 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:06:06,134 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:06:06,135 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功从Python代码块中提取代码
2025-03-17 14:06:06,135 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功生成数据分析代码
2025-03-17 14:06:06,135 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 开始执行并尝试修复代码...
2025-03-17 14:06:06,136 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 执行代码尝试 1/3
2025-03-17 14:06:06,136 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 在沙箱环境中执行代码...
2025-03-17 14:06:06,645 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行成功
2025-03-17 14:06:06,646 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:06:06,647 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\5_相关性分析单元_conclusion.txt
2025-03-17 14:06:06,647 - INFO - modules.analysis_dispatcher - 分析单元 相关性分析单元 执行成功
2025-03-17 14:06:06,649 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_140238
2025-03-17 14:06:06,650 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 5/5
2025-03-17 14:06:06,650 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 14:06:06,650 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 14:06:06,651 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 14:06:06,651 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 14:06:06,651 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 14:06:06,651 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:06:06,651 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:06:15,778 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:06:15,778 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:07:47,444 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:07:47,450 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports/html_report_20250317_140747.html
2025-03-17 14:07:47,540 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports/html_report_20250317_140747.html
2025-03-17 14:07:47,564 - INFO - modules.excel_analyzer - 已自动打开Markdown报告: reports/excel_analysis_report_20250317_140747.md
2025-03-17 14:07:47,597 - INFO - modules.excel_analyzer - 已自动打开HTML报告: reports/html_report_20250317_140747.html
2025-03-17 14:07:47,599 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_140747.md
2025-03-17 14:07:47,599 - INFO - __main__ - HTML图表报告已保存到: reports/excel_analysis_report_20250317_140747.html
2025-03-17 14:11:57,483 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 14:11:57,484 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 14:11:57,484 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 14:11:57,484 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 14:11:57,484 - INFO - __main__ - 初始化Excel分析器
2025-03-17 14:11:57,484 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 14:11:57,484 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 14:11:57,484 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 14:11:57,484 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 14:11:57,485 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 14:11:57,485 - INFO - modules.analysis_dispatcher - 已启用相关性分析单元
2025-03-17 14:11:57,485 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 14:11:57,485 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 14:11:57,485 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 14:11:57,485 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 14:11:57,485 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 14:11:57,485 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 14:11:57,485 - INFO - modules.analysis_dispatcher - 已启用相关性分析单元
2025-03-17 14:11:57,485 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 14:11:57,486 - INFO - __main__ - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:11:57,486 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:11:57,486 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:11:59,812 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317141159.csv
2025-03-17 14:11:59,812 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317141159.csv
2025-03-17 14:11:59,892 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 14:11:59,893 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 14:11:59,893 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 14:11:59,894 - INFO - modules.analysis_dispatcher - 执行分析单元 1/5: 总体数据统计分析单元
2025-03-17 14:11:59,894 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 14:11:59,895 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:11:59,895 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:11:59,895 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:12:03,781 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:12:03,781 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:12:57,200 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:12:57,202 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 14:12:57,202 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 14:12:57,202 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 14:12:57,203 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 14:12:57,203 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 14:12:57,714 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 14:12:57,714 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:12:57,715 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 14:12:57,717 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 14:12:57,717 - INFO - modules.analysis_dispatcher - 执行分析单元 2/5: 分组对比分析单元
2025-03-17 14:12:57,717 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 正在生成数据分析代码...
2025-03-17 14:12:57,717 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:12:57,718 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:12:57,718 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:13:01,970 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:13:01,973 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:14:56,643 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:14:56,653 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功从Python代码块中提取代码
2025-03-17 14:14:56,656 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功生成数据分析代码
2025-03-17 14:14:56,657 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 开始执行并尝试修复代码...
2025-03-17 14:14:56,661 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 执行代码尝试 1/3
2025-03-17 14:14:56,663 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 在沙箱环境中执行代码...
2025-03-17 14:14:57,132 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行成功
2025-03-17 14:14:57,132 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:14:57,133 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_分组对比分析单元_conclusion.txt
2025-03-17 14:14:57,134 - INFO - modules.analysis_dispatcher - 分析单元 分组对比分析单元 执行成功
2025-03-17 14:14:57,134 - INFO - modules.analysis_dispatcher - 执行分析单元 3/5: 比例分析单元
2025-03-17 14:14:57,134 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 正在生成数据分析代码...
2025-03-17 14:14:57,135 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:14:57,135 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:14:57,135 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:15:10,939 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:15:10,942 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:15:32,247 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:15:32,250 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 成功从Python代码块中提取代码
2025-03-17 14:15:32,251 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 成功生成数据分析代码
2025-03-17 14:15:32,251 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 开始执行并尝试修复代码...
2025-03-17 14:15:32,252 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 执行代码尝试 1/3
2025-03-17 14:15:32,252 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 在沙箱环境中执行代码...
2025-03-17 14:15:32,664 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 代码执行成功
2025-03-17 14:15:32,664 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:15:32,665 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\3_比例分析单元_conclusion.txt
2025-03-17 14:15:32,666 - INFO - modules.analysis_dispatcher - 分析单元 比例分析单元 执行成功
2025-03-17 14:15:32,666 - INFO - modules.analysis_dispatcher - 执行分析单元 4/5: 时间趋势分析单元
2025-03-17 14:15:32,666 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在生成数据分析代码...
2025-03-17 14:15:32,667 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:15:32,667 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:15:32,667 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:15:37,546 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:15:37,547 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:15:48,768 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:15:48,769 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功从Python代码块中提取代码
2025-03-17 14:15:48,769 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功生成数据分析代码
2025-03-17 14:15:48,769 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 开始执行并尝试修复代码...
2025-03-17 14:15:48,770 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 执行代码尝试 1/3
2025-03-17 14:15:48,770 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 在沙箱环境中执行代码...
2025-03-17 14:15:49,896 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功
2025-03-17 14:15:49,896 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:15:49,897 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\4_时间趋势分析单元_conclusion.txt
2025-03-17 14:15:49,898 - INFO - modules.analysis_dispatcher - 分析单元 时间趋势分析单元 执行成功
2025-03-17 14:15:49,898 - INFO - modules.analysis_dispatcher - 执行分析单元 5/5: 相关性分析单元
2025-03-17 14:15:49,898 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 正在生成数据分析代码...
2025-03-17 14:15:49,899 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:15:49,899 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:15:49,899 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:15:53,972 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:15:53,972 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:16:18,075 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:16:18,076 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功从Python代码块中提取代码
2025-03-17 14:16:18,077 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功生成数据分析代码
2025-03-17 14:16:18,077 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 开始执行并尝试修复代码...
2025-03-17 14:16:18,077 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 执行代码尝试 1/3
2025-03-17 14:16:18,077 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 在沙箱环境中执行代码...
2025-03-17 14:16:18,508 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行成功
2025-03-17 14:16:18,509 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:16:18,510 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\5_相关性分析单元_conclusion.txt
2025-03-17 14:16:18,510 - INFO - modules.analysis_dispatcher - 分析单元 相关性分析单元 执行成功
2025-03-17 14:16:18,512 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_141159
2025-03-17 14:16:18,512 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 5/5
2025-03-17 14:16:18,512 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 14:16:18,512 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 14:16:18,513 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 14:16:18,513 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 14:16:18,513 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 14:16:18,513 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:16:18,513 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:16:26,122 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:16:26,126 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:16:40,072 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:16:40,077 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports/html_report_20250317_141640.html
2025-03-17 14:16:40,172 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports/html_report_20250317_141640.html
2025-03-17 14:16:40,188 - INFO - modules.excel_analyzer - 已自动打开HTML报告: reports/html_report_20250317_141640.html
2025-03-17 14:16:40,189 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_141640.md
2025-03-17 14:16:40,190 - INFO - __main__ - HTML图表报告已保存到: reports/excel_analysis_report_20250317_141640.html
2025-03-17 14:24:05,906 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 14:24:05,906 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 14:24:05,906 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 14:24:05,907 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 14:24:05,907 - INFO - __main__ - 初始化Excel分析器
2025-03-17 14:24:05,907 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 14:24:05,907 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 14:24:05,907 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 14:24:05,907 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 14:24:05,907 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 14:24:05,907 - INFO - modules.analysis_dispatcher - 已启用相关性分析单元
2025-03-17 14:24:05,907 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 14:24:05,908 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 14:24:05,908 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 14:24:05,908 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 14:24:05,908 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 14:24:05,908 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 14:24:05,908 - INFO - modules.analysis_dispatcher - 已启用相关性分析单元
2025-03-17 14:24:05,908 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 14:24:05,908 - INFO - __main__ - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:24:05,908 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:24:05,909 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:24:08,252 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317142408.csv
2025-03-17 14:24:08,252 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317142408.csv
2025-03-17 14:24:08,339 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 14:24:08,340 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 14:24:08,340 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 14:24:08,341 - INFO - modules.analysis_dispatcher - 执行分析单元 1/5: 总体数据统计分析单元
2025-03-17 14:24:08,342 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 14:24:08,342 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:24:08,342 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:24:08,342 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:24:12,987 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:24:12,988 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:24:24,268 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:24:24,269 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 从不完整的Python代码块中提取代码
2025-03-17 14:24:24,270 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 14:24:24,270 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 14:24:24,270 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 14:24:24,270 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 14:24:24,622 - WARNING - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行失败，错误码: 1
2025-03-17 14:24:24,622 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行失败，尝试修复（尝试 1/3）
2025-03-17 14:24:24,622 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在修复数据分析代码...
2025-03-17 14:24:24,622 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API修复代码（流式输出）...
2025-03-17 14:24:24,623 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:24:24,623 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:24:28,264 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:24:28,264 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:25:03,810 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:25:03,811 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 14:25:03,811 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功修复数据分析代码
2025-03-17 14:25:03,811 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 2/3
2025-03-17 14:25:03,812 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 14:25:04,153 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 14:25:04,154 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 2/3）
2025-03-17 14:25:04,154 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 14:25:04,155 - INFO - modules.analysis_dispatcher - 已为分析单元 总体数据统计分析单元 生成独立的Markdown报告: reports\总体数据统计分析_20250317_142504.md
2025-03-17 14:25:04,156 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 14:25:04,156 - INFO - modules.analysis_dispatcher - 执行分析单元 2/5: 分组对比分析单元
2025-03-17 14:25:04,156 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 正在生成数据分析代码...
2025-03-17 14:25:04,156 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:25:04,156 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:25:04,157 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:25:10,976 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:25:10,976 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:26:03,868 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:26:03,869 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功从Python代码块中提取代码
2025-03-17 14:26:03,869 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功生成数据分析代码
2025-03-17 14:26:03,869 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 开始执行并尝试修复代码...
2025-03-17 14:26:03,870 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 执行代码尝试 1/3
2025-03-17 14:26:03,870 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 在沙箱环境中执行代码...
2025-03-17 14:26:04,304 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行成功
2025-03-17 14:26:04,304 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:26:04,305 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_分组对比分析单元_conclusion.txt
2025-03-17 14:26:04,306 - INFO - modules.analysis_dispatcher - 已为分析单元 分组对比分析单元 生成独立的Markdown报告: reports\分组对比分析_20250317_142604.md
2025-03-17 14:26:04,306 - INFO - modules.analysis_dispatcher - 分析单元 分组对比分析单元 执行成功
2025-03-17 14:26:04,306 - INFO - modules.analysis_dispatcher - 执行分析单元 3/5: 比例分析单元
2025-03-17 14:26:04,306 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 正在生成数据分析代码...
2025-03-17 14:26:04,306 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:26:04,307 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:26:04,307 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:26:10,918 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:26:10,919 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:26:20,356 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:26:20,358 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 成功从Python代码块中提取代码
2025-03-17 14:26:20,358 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 成功生成数据分析代码
2025-03-17 14:26:20,358 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 开始执行并尝试修复代码...
2025-03-17 14:26:20,359 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 执行代码尝试 1/3
2025-03-17 14:26:20,359 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 在沙箱环境中执行代码...
2025-03-17 14:26:20,780 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 代码执行成功
2025-03-17 14:26:20,781 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:26:20,781 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\3_比例分析单元_conclusion.txt
2025-03-17 14:26:20,783 - INFO - modules.analysis_dispatcher - 已为分析单元 比例分析单元 生成独立的Markdown报告: reports\比例分析_20250317_142620.md
2025-03-17 14:26:20,783 - INFO - modules.analysis_dispatcher - 分析单元 比例分析单元 执行成功
2025-03-17 14:26:20,783 - INFO - modules.analysis_dispatcher - 执行分析单元 4/5: 时间趋势分析单元
2025-03-17 14:26:20,783 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在生成数据分析代码...
2025-03-17 14:26:20,784 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:26:20,785 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:26:20,785 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:26:41,461 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:26:41,461 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:27:43,661 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:27:43,664 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功从Python代码块中提取代码
2025-03-17 14:27:43,664 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功生成数据分析代码
2025-03-17 14:27:43,664 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 开始执行并尝试修复代码...
2025-03-17 14:27:43,665 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 执行代码尝试 1/3
2025-03-17 14:27:43,665 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 在沙箱环境中执行代码...
2025-03-17 14:27:44,643 - WARNING - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行失败，错误码: 1
2025-03-17 14:27:44,644 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行失败，尝试修复（尝试 1/3）
2025-03-17 14:27:44,644 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在修复数据分析代码...
2025-03-17 14:27:44,644 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 尝试调用API修复代码（流式输出）...
2025-03-17 14:27:44,644 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:27:44,645 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:27:48,461 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:27:48,463 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:28:24,609 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:28:24,610 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功从Python代码块中提取代码
2025-03-17 14:28:24,610 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功修复数据分析代码
2025-03-17 14:28:24,611 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 执行代码尝试 2/3
2025-03-17 14:28:24,611 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 在沙箱环境中执行代码...
2025-03-17 14:28:25,618 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功
2025-03-17 14:28:25,618 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功（尝试 2/3）
2025-03-17 14:28:25,620 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\4_时间趋势分析单元_conclusion.txt
2025-03-17 14:28:25,621 - INFO - modules.analysis_dispatcher - 已为分析单元 时间趋势分析单元 生成独立的Markdown报告: reports\时间趋势分析_20250317_142825.md
2025-03-17 14:28:25,621 - INFO - modules.analysis_dispatcher - 分析单元 时间趋势分析单元 执行成功
2025-03-17 14:28:25,621 - INFO - modules.analysis_dispatcher - 执行分析单元 5/5: 相关性分析单元
2025-03-17 14:28:25,621 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 正在生成数据分析代码...
2025-03-17 14:28:25,622 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:28:25,623 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:28:25,623 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:28:29,308 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:28:29,310 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:28:53,349 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:28:53,350 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功从Python代码块中提取代码
2025-03-17 14:28:53,350 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功生成数据分析代码
2025-03-17 14:28:53,350 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 开始执行并尝试修复代码...
2025-03-17 14:28:53,351 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 执行代码尝试 1/3
2025-03-17 14:28:53,351 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 在沙箱环境中执行代码...
2025-03-17 14:28:53,785 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行成功
2025-03-17 14:28:53,785 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:28:53,786 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\5_相关性分析单元_conclusion.txt
2025-03-17 14:28:53,786 - INFO - modules.analysis_dispatcher - 已为分析单元 相关性分析单元 生成独立的Markdown报告: reports\相关性分析_20250317_142853.md
2025-03-17 14:28:53,787 - INFO - modules.analysis_dispatcher - 分析单元 相关性分析单元 执行成功
2025-03-17 14:28:53,788 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_142408
2025-03-17 14:28:53,789 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 5/5
2025-03-17 14:28:53,789 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 14:28:53,789 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 14:28:53,789 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 14:28:53,790 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 14:28:53,790 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 14:28:53,790 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:28:53,790 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:29:01,191 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:29:01,192 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:30:16,647 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:30:16,657 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports/html_report_20250317_143016.html
2025-03-17 14:30:16,749 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports/html_report_20250317_143016.html
2025-03-17 14:30:16,750 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\总体数据统计分析_20250317_142504.html
2025-03-17 14:30:16,766 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\总体数据统计分析_20250317_142504.html
2025-03-17 14:30:16,766 - INFO - modules.excel_analyzer - 已将分析单元 总体数据统计分析单元 的Markdown报告转换为HTML: reports\总体数据统计分析_20250317_142504.html
2025-03-17 14:30:16,767 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\分组对比分析_20250317_142604.html
2025-03-17 14:30:16,818 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\分组对比分析_20250317_142604.html
2025-03-17 14:30:16,818 - INFO - modules.excel_analyzer - 已将分析单元 分组对比分析单元 的Markdown报告转换为HTML: reports\分组对比分析_20250317_142604.html
2025-03-17 14:30:16,820 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\比例分析_20250317_142620.html
2025-03-17 14:30:16,866 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\比例分析_20250317_142620.html
2025-03-17 14:30:16,867 - INFO - modules.excel_analyzer - 已将分析单元 比例分析单元 的Markdown报告转换为HTML: reports\比例分析_20250317_142620.html
2025-03-17 14:30:16,868 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\时间趋势分析_20250317_142825.html
2025-03-17 14:30:16,916 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\时间趋势分析_20250317_142825.html
2025-03-17 14:30:16,916 - INFO - modules.excel_analyzer - 已将分析单元 时间趋势分析单元 的Markdown报告转换为HTML: reports\时间趋势分析_20250317_142825.html
2025-03-17 14:30:16,918 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\相关性分析_20250317_142853.html
2025-03-17 14:30:16,956 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\相关性分析_20250317_142853.html
2025-03-17 14:30:16,959 - INFO - modules.excel_analyzer - 已将分析单元 相关性分析单元 的Markdown报告转换为HTML: reports\相关性分析_20250317_142853.html
2025-03-17 14:30:17,015 - INFO - modules.excel_analyzer - 已自动打开HTML报告: reports/html_report_20250317_143016.html
2025-03-17 14:30:17,074 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\总体数据统计分析_20250317_142504.html
2025-03-17 14:30:17,110 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\分组对比分析_20250317_142604.html
2025-03-17 14:30:17,144 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\比例分析_20250317_142620.html
2025-03-17 14:30:17,185 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\时间趋势分析_20250317_142825.html
2025-03-17 14:30:17,209 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\相关性分析_20250317_142853.html
2025-03-17 14:30:17,211 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_143017.md
2025-03-17 14:30:17,211 - INFO - __main__ - HTML图表报告已保存到: reports/html_report_20250317_143016.html
2025-03-17 14:35:55,336 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 14:35:55,336 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 14:35:55,336 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 14:35:55,336 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 14:35:55,336 - INFO - __main__ - 初始化Excel分析器
2025-03-17 14:35:55,337 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 14:35:55,337 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 14:35:55,337 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 14:35:55,337 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 14:35:55,337 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 14:35:55,337 - INFO - modules.analysis_dispatcher - 已启用相关性分析单元
2025-03-17 14:35:55,337 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 14:35:55,337 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 14:35:55,337 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 14:35:55,338 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 14:35:55,338 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 14:35:55,338 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 14:35:55,338 - INFO - modules.analysis_dispatcher - 已启用相关性分析单元
2025-03-17 14:35:55,338 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 14:35:55,338 - INFO - __main__ - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:35:55,338 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:35:55,338 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:35:57,688 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317143557.csv
2025-03-17 14:35:57,689 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317143557.csv
2025-03-17 14:35:57,769 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 14:35:57,770 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 14:35:57,770 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 14:35:57,771 - INFO - modules.analysis_dispatcher - 执行分析单元 1/5: 总体数据统计分析单元
2025-03-17 14:35:57,772 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 14:35:57,772 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:35:57,772 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:35:57,772 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:36:02,547 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:36:02,549 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:36:57,198 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:36:57,200 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 14:36:57,200 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 14:36:57,200 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 14:36:57,201 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 14:36:57,201 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 14:36:57,679 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 14:36:57,680 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:36:57,680 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 14:36:57,681 - INFO - modules.analysis_dispatcher - 已为分析单元 总体数据统计分析单元 生成独立的Markdown报告: reports\总体数据统计分析_20250317_143657.md
2025-03-17 14:36:57,682 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 14:36:57,682 - INFO - modules.analysis_dispatcher - 执行分析单元 2/5: 分组对比分析单元
2025-03-17 14:36:57,682 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 正在生成数据分析代码...
2025-03-17 14:36:57,682 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:36:57,682 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:36:57,683 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:37:01,833 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:37:01,833 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:38:02,253 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:38:02,255 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功从Python代码块中提取代码
2025-03-17 14:38:02,255 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功生成数据分析代码
2025-03-17 14:38:02,255 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 开始执行并尝试修复代码...
2025-03-17 14:38:02,255 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 执行代码尝试 1/3
2025-03-17 14:38:02,256 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 在沙箱环境中执行代码...
2025-03-17 14:38:02,708 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行成功
2025-03-17 14:38:02,708 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:38:02,709 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_分组对比分析单元_conclusion.txt
2025-03-17 14:38:02,711 - INFO - modules.analysis_dispatcher - 已为分析单元 分组对比分析单元 生成独立的Markdown报告: reports\分组对比分析_20250317_143802.md
2025-03-17 14:38:02,711 - INFO - modules.analysis_dispatcher - 分析单元 分组对比分析单元 执行成功
2025-03-17 14:38:02,712 - INFO - modules.analysis_dispatcher - 执行分析单元 3/5: 比例分析单元
2025-03-17 14:38:02,712 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 正在生成数据分析代码...
2025-03-17 14:38:02,712 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:38:02,713 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:38:02,713 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:38:08,643 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:38:08,643 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:38:18,231 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:38:18,232 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 成功从Python代码块中提取代码
2025-03-17 14:38:18,232 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 成功生成数据分析代码
2025-03-17 14:38:18,233 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 开始执行并尝试修复代码...
2025-03-17 14:38:18,233 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 执行代码尝试 1/3
2025-03-17 14:38:18,233 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 在沙箱环境中执行代码...
2025-03-17 14:38:18,650 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 代码执行成功
2025-03-17 14:38:18,651 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:38:18,651 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\3_比例分析单元_conclusion.txt
2025-03-17 14:38:18,653 - INFO - modules.analysis_dispatcher - 已为分析单元 比例分析单元 生成独立的Markdown报告: reports\比例分析_20250317_143818.md
2025-03-17 14:38:18,653 - INFO - modules.analysis_dispatcher - 分析单元 比例分析单元 执行成功
2025-03-17 14:38:18,653 - INFO - modules.analysis_dispatcher - 执行分析单元 4/5: 时间趋势分析单元
2025-03-17 14:38:18,653 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在生成数据分析代码...
2025-03-17 14:38:18,653 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:38:18,654 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:38:18,654 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:38:23,107 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:38:23,108 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:39:30,047 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:39:30,048 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功从Python代码块中提取代码
2025-03-17 14:39:30,048 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功生成数据分析代码
2025-03-17 14:39:30,048 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 开始执行并尝试修复代码...
2025-03-17 14:39:30,049 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 执行代码尝试 1/3
2025-03-17 14:39:30,049 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 在沙箱环境中执行代码...
2025-03-17 14:39:31,184 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功
2025-03-17 14:39:31,185 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:39:31,186 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\4_时间趋势分析单元_conclusion.txt
2025-03-17 14:39:31,187 - INFO - modules.analysis_dispatcher - 已为分析单元 时间趋势分析单元 生成独立的Markdown报告: reports\时间趋势分析_20250317_143931.md
2025-03-17 14:39:31,187 - INFO - modules.analysis_dispatcher - 分析单元 时间趋势分析单元 执行成功
2025-03-17 14:39:31,187 - INFO - modules.analysis_dispatcher - 执行分析单元 5/5: 相关性分析单元
2025-03-17 14:39:31,187 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 正在生成数据分析代码...
2025-03-17 14:39:31,188 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:39:31,188 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:39:31,188 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:39:36,062 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:39:36,064 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:39:47,211 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:39:47,212 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功从Python代码块中提取代码
2025-03-17 14:39:47,212 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功生成数据分析代码
2025-03-17 14:39:47,212 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 开始执行并尝试修复代码...
2025-03-17 14:39:47,213 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 执行代码尝试 1/3
2025-03-17 14:39:47,213 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 在沙箱环境中执行代码...
2025-03-17 14:39:47,645 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行成功
2025-03-17 14:39:47,646 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:39:47,646 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\5_相关性分析单元_conclusion.txt
2025-03-17 14:39:47,647 - INFO - modules.analysis_dispatcher - 已为分析单元 相关性分析单元 生成独立的Markdown报告: reports\相关性分析_20250317_143947.md
2025-03-17 14:39:47,647 - INFO - modules.analysis_dispatcher - 分析单元 相关性分析单元 执行成功
2025-03-17 14:39:47,649 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_143557
2025-03-17 14:39:47,649 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 5/5
2025-03-17 14:39:47,650 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 14:39:47,650 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 14:39:47,650 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 14:39:47,650 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 14:39:47,651 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 14:39:47,651 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:39:47,651 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:40:06,787 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:40:06,787 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:40:20,397 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:40:20,403 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports/html_report_20250317_144020.html
2025-03-17 14:40:20,495 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports/html_report_20250317_144020.html
2025-03-17 14:40:20,496 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\总体数据统计分析_20250317_143657.html
2025-03-17 14:40:20,514 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\总体数据统计分析_20250317_143657.html
2025-03-17 14:40:20,514 - INFO - modules.excel_analyzer - 已将分析单元 总体数据统计分析单元 的Markdown报告转换为HTML: reports\总体数据统计分析_20250317_143657.html
2025-03-17 14:40:20,517 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\分组对比分析_20250317_143802.html
2025-03-17 14:40:20,560 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\分组对比分析_20250317_143802.html
2025-03-17 14:40:20,561 - INFO - modules.excel_analyzer - 已将分析单元 分组对比分析单元 的Markdown报告转换为HTML: reports\分组对比分析_20250317_143802.html
2025-03-17 14:40:20,564 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\比例分析_20250317_143818.html
2025-03-17 14:40:20,600 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\比例分析_20250317_143818.html
2025-03-17 14:40:20,600 - INFO - modules.excel_analyzer - 已将分析单元 比例分析单元 的Markdown报告转换为HTML: reports\比例分析_20250317_143818.html
2025-03-17 14:40:20,602 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\时间趋势分析_20250317_143931.html
2025-03-17 14:40:20,648 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\时间趋势分析_20250317_143931.html
2025-03-17 14:40:20,649 - INFO - modules.excel_analyzer - 已将分析单元 时间趋势分析单元 的Markdown报告转换为HTML: reports\时间趋势分析_20250317_143931.html
2025-03-17 14:40:20,650 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\相关性分析_20250317_143947.html
2025-03-17 14:40:20,677 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\相关性分析_20250317_143947.html
2025-03-17 14:40:20,678 - INFO - modules.excel_analyzer - 已将分析单元 相关性分析单元 的Markdown报告转换为HTML: reports\相关性分析_20250317_143947.html
2025-03-17 14:40:20,729 - INFO - modules.excel_analyzer - 已自动打开HTML报告: reports/html_report_20250317_144020.html
2025-03-17 14:40:20,750 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\总体数据统计分析_20250317_143657.html
2025-03-17 14:40:20,806 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\分组对比分析_20250317_143802.html
2025-03-17 14:40:20,831 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\比例分析_20250317_143818.html
2025-03-17 14:40:20,864 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\时间趋势分析_20250317_143931.html
2025-03-17 14:40:20,913 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\相关性分析_20250317_143947.html
2025-03-17 14:40:20,913 - INFO - modules.excel_analyzer - 开始生成综合分析报告...
2025-03-17 14:40:20,914 - INFO - modules.excel_analyzer - 开始生成综合分析报告...
2025-03-17 14:40:20,915 - INFO - modules.excel_analyzer - 开始流式生成综合Markdown报告...
2025-03-17 14:40:20,915 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 14:40:20,915 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 14:40:20,916 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:40:20,916 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:40:36,899 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:40:36,900 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:41:42,212 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:41:42,218 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports/comprehensive_html_report_20250317_144142.html
2025-03-17 14:41:42,240 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports/comprehensive_html_report_20250317_144142.html
2025-03-17 14:41:42,259 - INFO - modules.excel_analyzer - 已自动打开综合HTML报告: reports/comprehensive_html_report_20250317_144142.html
2025-03-17 14:41:42,260 - INFO - modules.excel_analyzer - 综合分析报告已生成: reports/comprehensive_html_report_20250317_144142.html
2025-03-17 14:41:42,261 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_144142.md
2025-03-17 14:41:42,262 - INFO - __main__ - HTML图表报告已保存到: reports/html_report_20250317_144020.html
2025-03-17 14:45:31,930 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 14:45:31,930 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 14:45:31,930 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 14:45:31,931 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 14:45:31,931 - INFO - __main__ - 初始化Excel分析器
2025-03-17 14:45:31,931 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 14:45:31,931 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 14:45:31,931 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 14:45:31,931 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 14:45:31,931 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 14:45:31,931 - INFO - modules.analysis_dispatcher - 已启用相关性分析单元
2025-03-17 14:45:31,931 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 14:45:31,932 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 14:45:31,932 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 14:45:31,932 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 14:45:31,932 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 14:45:31,932 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 14:45:31,932 - INFO - modules.analysis_dispatcher - 已启用相关性分析单元
2025-03-17 14:45:31,932 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 14:45:31,932 - INFO - __main__ - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:45:31,932 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:45:31,933 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:45:34,304 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317144534.csv
2025-03-17 14:45:34,305 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317144534.csv
2025-03-17 14:45:34,389 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 14:45:34,390 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 14:45:34,390 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 14:45:34,391 - INFO - modules.analysis_dispatcher - 执行分析单元 1/5: 总体数据统计分析单元
2025-03-17 14:45:34,392 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 14:45:34,392 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:45:34,392 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:45:34,392 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:45:39,701 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:45:39,702 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:46:57,377 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:46:57,378 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 14:46:57,379 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 14:46:57,379 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 14:46:57,379 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 14:46:57,379 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 14:46:57,849 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 14:46:57,849 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:46:57,850 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 14:46:57,850 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 总体数据统计分析单元 生成Markdown报告...
2025-03-17 14:46:57,851 - ERROR - modules.analysis_dispatcher - 使用大模型生成分析单元 总体数据统计分析单元 的报告时出错: EnhancedMarkdownReportGenerator.__init__() missing 2 required positional arguments: 'model_connector' and 'config'
2025-03-17 14:46:57,851 - INFO - modules.analysis_dispatcher - 已为分析单元 总体数据统计分析单元 生成独立的Markdown报告: reports\总体数据统计分析_20250317_144657.md
2025-03-17 14:46:57,851 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 14:46:57,851 - INFO - modules.analysis_dispatcher - 执行分析单元 2/5: 分组对比分析单元
2025-03-17 14:46:57,852 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 正在生成数据分析代码...
2025-03-17 14:46:57,852 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:46:57,852 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:46:57,852 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:47:16,057 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:47:16,062 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:49:05,726 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 14:49:05,726 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 14:49:05,726 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 14:49:05,726 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 14:49:05,727 - INFO - __main__ - 初始化Excel分析器
2025-03-17 14:49:05,727 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 14:49:05,727 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 14:49:05,727 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 14:49:05,727 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 14:49:05,727 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 14:49:05,727 - INFO - modules.analysis_dispatcher - 成功初始化 1 个分析单元
2025-03-17 14:49:05,728 - INFO - __main__ - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:49:05,728 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:49:05,728 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:49:08,076 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317144907.csv
2025-03-17 14:49:08,077 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317144907.csv
2025-03-17 14:49:08,158 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 14:49:08,159 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 14:49:08,159 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 14:49:08,160 - INFO - modules.analysis_dispatcher - 执行分析单元 1/1: 总体数据统计分析单元
2025-03-17 14:49:08,160 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 14:49:08,161 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:49:08,161 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:49:08,161 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:49:12,664 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:49:12,665 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:50:33,075 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:50:33,077 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 14:50:33,077 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 14:50:33,078 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 14:50:33,078 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 14:50:33,078 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 14:50:33,527 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 14:50:33,528 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:50:33,528 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 14:50:33,529 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 总体数据统计分析单元 生成Markdown报告...
2025-03-17 14:50:33,529 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 14:50:33,529 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 14:50:33,530 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:50:33,530 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:50:38,227 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:50:38,228 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:52:13,223 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:52:13,231 - INFO - modules.analysis_dispatcher - 已为分析单元 总体数据统计分析单元 生成独立的Markdown报告: reports\总体数据统计分析_20250317_145213.md
2025-03-17 14:52:13,231 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 14:52:13,232 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_144908
2025-03-17 14:52:13,233 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 1/1
2025-03-17 14:52:13,233 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 14:52:13,233 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 14:52:13,233 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 14:52:13,233 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 14:52:13,233 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 14:52:13,234 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:52:13,234 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:52:17,678 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:52:17,678 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:53:48,393 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:53:48,397 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports/html_report_20250317_145348.html
2025-03-17 14:53:48,517 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports/html_report_20250317_145348.html
2025-03-17 14:53:48,519 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\总体数据统计分析_20250317_145213.html
2025-03-17 14:53:48,535 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\总体数据统计分析_20250317_145213.html
2025-03-17 14:53:48,536 - INFO - modules.excel_analyzer - 已将分析单元 总体数据统计分析单元 的Markdown报告转换为HTML: reports\总体数据统计分析_20250317_145213.html
2025-03-17 14:53:48,585 - INFO - modules.excel_analyzer - 已自动打开HTML报告: reports/html_report_20250317_145348.html
2025-03-17 14:53:48,643 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\总体数据统计分析_20250317_145213.html
2025-03-17 14:53:48,644 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_145348.md
2025-03-17 14:53:48,644 - INFO - __main__ - HTML图表报告已保存到: reports/html_report_20250317_145348.html
2025-03-17 14:55:52,570 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 14:55:52,571 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 14:55:52,571 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 14:55:52,571 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 14:55:52,571 - INFO - __main__ - 初始化Excel分析器
2025-03-17 14:55:52,571 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 14:55:52,571 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 14:55:52,572 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 14:55:52,572 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 14:55:52,572 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 14:55:52,572 - INFO - modules.analysis_dispatcher - 已启用相关性分析单元
2025-03-17 14:55:52,572 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 14:55:52,572 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 14:55:52,573 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 14:55:52,573 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 14:55:52,573 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 14:55:52,573 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 14:55:52,573 - INFO - modules.analysis_dispatcher - 已启用相关性分析单元
2025-03-17 14:55:52,573 - INFO - modules.analysis_dispatcher - 成功初始化 5 个分析单元
2025-03-17 14:55:52,573 - INFO - __main__ - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:55:52,574 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:55:52,574 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 14:55:54,926 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317145554.csv
2025-03-17 14:55:54,927 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317145554.csv
2025-03-17 14:55:55,031 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 14:55:55,032 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 14:55:55,032 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 14:55:55,033 - INFO - modules.analysis_dispatcher - 执行分析单元 1/5: 总体数据统计分析单元
2025-03-17 14:55:55,033 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 14:55:55,034 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:55:55,034 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:55:55,034 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:55:59,399 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:55:59,400 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:56:34,160 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:56:34,162 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 14:56:34,162 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 14:56:34,162 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 14:56:34,163 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 14:56:34,163 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 14:56:34,630 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 14:56:34,630 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:56:34,631 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 14:56:34,632 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 总体数据统计分析单元 生成Markdown报告...
2025-03-17 14:56:34,632 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 14:56:34,632 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 14:56:34,632 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:56:34,633 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:56:40,910 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:56:40,911 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:58:05,952 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:58:05,960 - INFO - modules.analysis_dispatcher - 已为分析单元 总体数据统计分析单元 生成独立的Markdown报告: reports\总体数据统计分析_20250317_145805.md
2025-03-17 14:58:05,960 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 14:58:05,960 - INFO - modules.analysis_dispatcher - 执行分析单元 2/5: 分组对比分析单元
2025-03-17 14:58:05,961 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 正在生成数据分析代码...
2025-03-17 14:58:05,961 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:58:05,961 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:58:05,961 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:58:09,056 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:58:09,057 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:59:03,784 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:59:03,785 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功从Python代码块中提取代码
2025-03-17 14:59:03,785 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功生成数据分析代码
2025-03-17 14:59:03,786 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 开始执行并尝试修复代码...
2025-03-17 14:59:03,786 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 执行代码尝试 1/3
2025-03-17 14:59:03,786 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 在沙箱环境中执行代码...
2025-03-17 14:59:04,252 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行成功
2025-03-17 14:59:04,253 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行成功（尝试 1/3）
2025-03-17 14:59:04,254 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_分组对比分析单元_conclusion.txt
2025-03-17 14:59:04,255 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 分组对比分析单元 生成Markdown报告...
2025-03-17 14:59:04,255 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 14:59:04,255 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 14:59:04,255 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:59:04,256 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:59:10,646 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:59:10,646 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 14:59:48,319 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 14:59:48,323 - INFO - modules.analysis_dispatcher - 已为分析单元 分组对比分析单元 生成独立的Markdown报告: reports\分组对比分析_20250317_145948.md
2025-03-17 14:59:48,323 - INFO - modules.analysis_dispatcher - 分析单元 分组对比分析单元 执行成功
2025-03-17 14:59:48,323 - INFO - modules.analysis_dispatcher - 执行分析单元 3/5: 比例分析单元
2025-03-17 14:59:48,323 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 正在生成数据分析代码...
2025-03-17 14:59:48,323 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 14:59:48,324 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 14:59:48,324 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 14:59:51,381 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 14:59:51,382 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:00:13,429 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:00:13,430 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 成功从Python代码块中提取代码
2025-03-17 15:00:13,430 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 成功生成数据分析代码
2025-03-17 15:00:13,430 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 开始执行并尝试修复代码...
2025-03-17 15:00:13,431 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 执行代码尝试 1/3
2025-03-17 15:00:13,431 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 在沙箱环境中执行代码...
2025-03-17 15:00:13,868 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 代码执行成功
2025-03-17 15:00:13,869 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 代码执行成功（尝试 1/3）
2025-03-17 15:00:13,869 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\3_比例分析单元_conclusion.txt
2025-03-17 15:00:13,870 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 比例分析单元 生成Markdown报告...
2025-03-17 15:00:13,870 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:00:13,870 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:00:13,871 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:00:13,871 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:00:20,962 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:00:20,963 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:01:06,051 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:01:06,054 - INFO - modules.analysis_dispatcher - 已为分析单元 比例分析单元 生成独立的Markdown报告: reports\比例分析_20250317_150106.md
2025-03-17 15:01:06,054 - INFO - modules.analysis_dispatcher - 分析单元 比例分析单元 执行成功
2025-03-17 15:01:06,055 - INFO - modules.analysis_dispatcher - 执行分析单元 4/5: 时间趋势分析单元
2025-03-17 15:01:06,055 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在生成数据分析代码...
2025-03-17 15:01:06,056 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 15:01:06,056 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:01:06,057 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:01:11,539 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:01:11,541 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:02:41,072 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:02:41,073 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功从Python代码块中提取代码
2025-03-17 15:02:41,073 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功生成数据分析代码
2025-03-17 15:02:41,074 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 开始执行并尝试修复代码...
2025-03-17 15:02:41,074 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 执行代码尝试 1/3
2025-03-17 15:02:41,074 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 在沙箱环境中执行代码...
2025-03-17 15:02:42,168 - WARNING - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行失败，错误码: 1
2025-03-17 15:02:42,169 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行失败，尝试修复（尝试 1/3）
2025-03-17 15:02:42,169 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在修复数据分析代码...
2025-03-17 15:02:42,169 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 尝试调用API修复代码（流式输出）...
2025-03-17 15:02:42,170 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:02:42,170 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:02:50,086 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:02:50,086 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:04:26,047 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:04:26,048 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功从Python代码块中提取代码
2025-03-17 15:04:26,048 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功修复数据分析代码
2025-03-17 15:04:26,048 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 执行代码尝试 2/3
2025-03-17 15:04:26,049 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 在沙箱环境中执行代码...
2025-03-17 15:04:27,145 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功
2025-03-17 15:04:27,146 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功（尝试 2/3）
2025-03-17 15:04:27,147 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\4_时间趋势分析单元_conclusion.txt
2025-03-17 15:04:27,148 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 时间趋势分析单元 生成Markdown报告...
2025-03-17 15:04:27,148 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:04:27,148 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:04:27,148 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:04:27,148 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:04:30,813 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:04:30,813 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:05:38,632 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:05:38,636 - INFO - modules.analysis_dispatcher - 已为分析单元 时间趋势分析单元 生成独立的Markdown报告: reports\时间趋势分析_20250317_150538.md
2025-03-17 15:05:38,636 - INFO - modules.analysis_dispatcher - 分析单元 时间趋势分析单元 执行成功
2025-03-17 15:05:38,636 - INFO - modules.analysis_dispatcher - 执行分析单元 5/5: 相关性分析单元
2025-03-17 15:05:38,636 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 正在生成数据分析代码...
2025-03-17 15:05:38,637 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 15:05:38,637 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:05:38,637 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:05:45,013 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:05:45,014 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:06:19,077 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:06:19,078 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功从Python代码块中提取代码
2025-03-17 15:06:19,078 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 成功生成数据分析代码
2025-03-17 15:06:19,079 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 开始执行并尝试修复代码...
2025-03-17 15:06:19,079 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 执行代码尝试 1/3
2025-03-17 15:06:19,079 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 在沙箱环境中执行代码...
2025-03-17 15:06:19,499 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行成功
2025-03-17 15:06:19,499 - INFO - modules.analysis_units.base_analysis_unit - [相关性分析单元] 代码执行成功（尝试 1/3）
2025-03-17 15:06:19,500 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\5_相关性分析单元_conclusion.txt
2025-03-17 15:06:19,500 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 相关性分析单元 生成Markdown报告...
2025-03-17 15:06:19,501 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:06:19,501 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:06:19,501 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:06:19,501 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:06:30,725 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:06:30,727 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:07:24,155 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:07:24,160 - INFO - modules.analysis_dispatcher - 已为分析单元 相关性分析单元 生成独立的Markdown报告: reports\相关性分析_20250317_150724.md
2025-03-17 15:07:24,160 - INFO - modules.analysis_dispatcher - 分析单元 相关性分析单元 执行成功
2025-03-17 15:07:24,162 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_145555
2025-03-17 15:07:24,163 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 5/5
2025-03-17 15:07:24,163 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 15:07:24,163 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 15:07:24,163 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:07:24,164 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:07:24,164 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:07:24,164 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:07:24,164 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:07:42,313 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:07:42,315 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:07:56,848 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:07:56,851 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports/html_report_20250317_150756.html
2025-03-17 15:07:56,949 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports/html_report_20250317_150756.html
2025-03-17 15:07:56,950 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\总体数据统计分析_20250317_145805.html
2025-03-17 15:07:56,967 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\总体数据统计分析_20250317_145805.html
2025-03-17 15:07:56,968 - INFO - modules.excel_analyzer - 已将分析单元 总体数据统计分析单元 的Markdown报告转换为HTML: reports\总体数据统计分析_20250317_145805.html
2025-03-17 15:07:56,968 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\分组对比分析_20250317_145948.html
2025-03-17 15:07:57,012 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\分组对比分析_20250317_145948.html
2025-03-17 15:07:57,013 - INFO - modules.excel_analyzer - 已将分析单元 分组对比分析单元 的Markdown报告转换为HTML: reports\分组对比分析_20250317_145948.html
2025-03-17 15:07:57,014 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\比例分析_20250317_150106.html
2025-03-17 15:07:57,041 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\比例分析_20250317_150106.html
2025-03-17 15:07:57,042 - INFO - modules.excel_analyzer - 已将分析单元 比例分析单元 的Markdown报告转换为HTML: reports\比例分析_20250317_150106.html
2025-03-17 15:07:57,043 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\时间趋势分析_20250317_150538.html
2025-03-17 15:07:57,106 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\时间趋势分析_20250317_150538.html
2025-03-17 15:07:57,106 - INFO - modules.excel_analyzer - 已将分析单元 时间趋势分析单元 的Markdown报告转换为HTML: reports\时间趋势分析_20250317_150538.html
2025-03-17 15:07:57,108 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\相关性分析_20250317_150724.html
2025-03-17 15:07:57,138 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\相关性分析_20250317_150724.html
2025-03-17 15:07:57,139 - INFO - modules.excel_analyzer - 已将分析单元 相关性分析单元 的Markdown报告转换为HTML: reports\相关性分析_20250317_150724.html
2025-03-17 15:07:57,188 - INFO - modules.excel_analyzer - 已自动打开HTML报告: reports/html_report_20250317_150756.html
2025-03-17 15:07:57,216 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\总体数据统计分析_20250317_145805.html
2025-03-17 15:07:57,248 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\分组对比分析_20250317_145948.html
2025-03-17 15:07:57,309 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\比例分析_20250317_150106.html
2025-03-17 15:07:57,372 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\时间趋势分析_20250317_150538.html
2025-03-17 15:07:57,402 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\相关性分析_20250317_150724.html
2025-03-17 15:07:57,403 - INFO - modules.excel_analyzer - 开始生成综合分析报告...
2025-03-17 15:07:57,403 - INFO - modules.excel_analyzer - 开始生成综合分析报告...
2025-03-17 15:07:57,404 - INFO - modules.excel_analyzer - 开始流式生成综合Markdown报告...
2025-03-17 15:07:57,404 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:07:57,404 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:07:57,405 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:07:57,405 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:08:07,637 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:08:07,638 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:08:19,654 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:08:19,657 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports/comprehensive_html_report_20250317_150819.html
2025-03-17 15:08:19,673 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports/comprehensive_html_report_20250317_150819.html
2025-03-17 15:08:19,691 - INFO - modules.excel_analyzer - 已自动打开综合HTML报告: reports/comprehensive_html_report_20250317_150819.html
2025-03-17 15:08:19,691 - INFO - modules.excel_analyzer - 综合分析报告已生成: reports/comprehensive_html_report_20250317_150819.html
2025-03-17 15:08:19,692 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_150819.md
2025-03-17 15:08:19,692 - INFO - __main__ - HTML图表报告已保存到: reports/html_report_20250317_150756.html
2025-03-17 15:11:43,940 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 15:11:43,941 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 15:11:43,941 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 15:11:43,941 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 15:11:43,941 - INFO - __main__ - 初始化Excel分析器
2025-03-17 15:11:43,942 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 15:11:43,942 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 15:11:43,942 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 15:11:43,942 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 15:11:43,942 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 15:11:43,942 - INFO - modules.analysis_dispatcher - 成功初始化 4 个分析单元
2025-03-17 15:11:43,943 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 15:11:43,943 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 15:11:43,943 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 15:11:43,943 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 15:11:43,943 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 15:11:43,943 - INFO - modules.analysis_dispatcher - 成功初始化 4 个分析单元
2025-03-17 15:11:43,943 - INFO - __main__ - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 15:11:43,943 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 15:11:43,943 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/server_monitoring_data_2025_02_28.xlsx
2025-03-17 15:11:46,290 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317151146.csv
2025-03-17 15:11:46,290 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317151146.csv
2025-03-17 15:11:46,372 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 15:11:46,372 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 15:11:46,373 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 15:11:46,374 - INFO - modules.analysis_dispatcher - 执行分析单元 1/4: 总体数据统计分析单元
2025-03-17 15:11:46,374 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 15:11:46,375 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 15:11:46,375 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:11:46,375 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:11:56,150 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:11:56,153 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:12:13,516 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:12:13,517 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 15:12:13,518 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 15:12:13,518 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 15:12:13,518 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 15:12:13,519 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 15:12:13,931 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 15:12:13,932 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 15:12:13,932 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 15:12:13,933 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 总体数据统计分析单元 生成Markdown报告...
2025-03-17 15:12:13,933 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:12:13,933 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:12:13,933 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:12:13,933 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:12:18,269 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:12:18,273 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:12:55,541 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:12:55,552 - INFO - modules.analysis_dispatcher - 已为分析单元 总体数据统计分析单元 生成独立的Markdown报告: reports\总体数据统计分析_20250317_151255.md
2025-03-17 15:12:55,553 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 15:12:55,554 - INFO - modules.analysis_dispatcher - 执行分析单元 2/4: 分组对比分析单元
2025-03-17 15:12:55,554 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 正在生成数据分析代码...
2025-03-17 15:12:55,555 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 15:12:55,555 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:12:55,556 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:12:59,708 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:12:59,708 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:13:48,380 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:13:48,382 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功从Python代码块中提取代码
2025-03-17 15:13:48,382 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功生成数据分析代码
2025-03-17 15:13:48,382 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 开始执行并尝试修复代码...
2025-03-17 15:13:48,383 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 执行代码尝试 1/3
2025-03-17 15:13:48,383 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 在沙箱环境中执行代码...
2025-03-17 15:13:48,863 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行成功
2025-03-17 15:13:48,863 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行成功（尝试 1/3）
2025-03-17 15:13:48,864 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_分组对比分析单元_conclusion.txt
2025-03-17 15:13:48,865 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 分组对比分析单元 生成Markdown报告...
2025-03-17 15:13:48,865 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:13:48,865 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:13:48,865 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:13:48,865 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:13:53,239 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:13:53,241 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:15:09,957 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:15:09,963 - INFO - modules.analysis_dispatcher - 已为分析单元 分组对比分析单元 生成独立的Markdown报告: reports\分组对比分析_20250317_151509.md
2025-03-17 15:15:09,963 - INFO - modules.analysis_dispatcher - 分析单元 分组对比分析单元 执行成功
2025-03-17 15:15:09,963 - INFO - modules.analysis_dispatcher - 执行分析单元 3/4: 比例分析单元
2025-03-17 15:15:09,964 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 正在生成数据分析代码...
2025-03-17 15:15:09,964 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 15:15:09,964 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:15:09,964 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:15:14,552 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:15:14,555 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:16:19,075 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:16:19,077 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 成功从Python代码块中提取代码
2025-03-17 15:16:19,077 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 成功生成数据分析代码
2025-03-17 15:16:19,077 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 开始执行并尝试修复代码...
2025-03-17 15:16:19,078 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 执行代码尝试 1/3
2025-03-17 15:16:19,078 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 在沙箱环境中执行代码...
2025-03-17 15:16:19,571 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 代码执行成功
2025-03-17 15:16:19,572 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 代码执行成功（尝试 1/3）
2025-03-17 15:16:19,573 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\3_比例分析单元_conclusion.txt
2025-03-17 15:16:19,574 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 比例分析单元 生成Markdown报告...
2025-03-17 15:16:19,574 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:16:19,574 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:16:19,574 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:16:19,574 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:16:36,367 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:16:36,370 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:16:48,982 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:16:48,984 - INFO - modules.analysis_dispatcher - 已为分析单元 比例分析单元 生成独立的Markdown报告: reports\比例分析_20250317_151648.md
2025-03-17 15:16:48,984 - INFO - modules.analysis_dispatcher - 分析单元 比例分析单元 执行成功
2025-03-17 15:16:48,984 - INFO - modules.analysis_dispatcher - 执行分析单元 4/4: 时间趋势分析单元
2025-03-17 15:16:48,984 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在生成数据分析代码...
2025-03-17 15:16:48,985 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 15:16:48,985 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:16:48,986 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:16:53,975 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:16:53,975 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:17:53,458 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:17:53,460 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功从Python代码块中提取代码
2025-03-17 15:17:53,460 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功生成数据分析代码
2025-03-17 15:17:53,460 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 开始执行并尝试修复代码...
2025-03-17 15:17:53,460 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 执行代码尝试 1/3
2025-03-17 15:17:53,461 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 在沙箱环境中执行代码...
2025-03-17 15:17:54,406 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功
2025-03-17 15:17:54,407 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功（尝试 1/3）
2025-03-17 15:17:54,408 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\4_时间趋势分析单元_conclusion.txt
2025-03-17 15:17:54,408 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 时间趋势分析单元 生成Markdown报告...
2025-03-17 15:17:54,409 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:17:54,409 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:17:54,409 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:17:54,409 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:17:57,388 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:17:57,388 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:18:34,770 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:18:34,774 - INFO - modules.analysis_dispatcher - 已为分析单元 时间趋势分析单元 生成独立的Markdown报告: reports\时间趋势分析_20250317_151834.md
2025-03-17 15:18:34,775 - INFO - modules.analysis_dispatcher - 分析单元 时间趋势分析单元 执行成功
2025-03-17 15:18:34,776 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_151146
2025-03-17 15:18:34,777 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 4/4
2025-03-17 15:18:34,777 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 15:18:34,777 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 15:18:34,777 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:18:34,777 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:18:34,778 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:18:34,778 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:18:34,778 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:18:43,342 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:18:43,345 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:18:57,213 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:18:57,216 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports/html_report_20250317_151857.html
2025-03-17 15:18:57,313 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports/html_report_20250317_151857.html
2025-03-17 15:18:57,314 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\总体数据统计分析_20250317_151255.html
2025-03-17 15:18:57,332 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\总体数据统计分析_20250317_151255.html
2025-03-17 15:18:57,332 - INFO - modules.excel_analyzer - 已将分析单元 总体数据统计分析单元 的Markdown报告转换为HTML: reports\总体数据统计分析_20250317_151255.html
2025-03-17 15:18:57,333 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\分组对比分析_20250317_151509.html
2025-03-17 15:18:57,385 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\分组对比分析_20250317_151509.html
2025-03-17 15:18:57,386 - INFO - modules.excel_analyzer - 已将分析单元 分组对比分析单元 的Markdown报告转换为HTML: reports\分组对比分析_20250317_151509.html
2025-03-17 15:18:57,387 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\比例分析_20250317_151648.html
2025-03-17 15:18:57,424 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\比例分析_20250317_151648.html
2025-03-17 15:18:57,426 - INFO - modules.excel_analyzer - 已将分析单元 比例分析单元 的Markdown报告转换为HTML: reports\比例分析_20250317_151648.html
2025-03-17 15:18:57,427 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\时间趋势分析_20250317_151834.html
2025-03-17 15:18:57,467 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\时间趋势分析_20250317_151834.html
2025-03-17 15:18:57,468 - INFO - modules.excel_analyzer - 已将分析单元 时间趋势分析单元 的Markdown报告转换为HTML: reports\时间趋势分析_20250317_151834.html
2025-03-17 15:18:57,514 - INFO - modules.excel_analyzer - 已自动打开HTML报告: reports/html_report_20250317_151857.html
2025-03-17 15:18:57,548 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\总体数据统计分析_20250317_151255.html
2025-03-17 15:18:57,604 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\分组对比分析_20250317_151509.html
2025-03-17 15:18:57,628 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\比例分析_20250317_151648.html
2025-03-17 15:18:57,679 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\时间趋势分析_20250317_151834.html
2025-03-17 15:18:57,679 - INFO - modules.excel_analyzer - 开始生成综合分析报告...
2025-03-17 15:18:57,680 - INFO - modules.excel_analyzer - 开始生成综合分析报告...
2025-03-17 15:18:57,680 - INFO - modules.excel_analyzer - 开始流式生成综合Markdown报告...
2025-03-17 15:18:57,681 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:18:57,681 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:18:57,681 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:18:57,681 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:19:01,961 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:19:01,962 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:20:18,297 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:20:18,305 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports/comprehensive_html_report_20250317_152018.html
2025-03-17 15:20:18,327 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports/comprehensive_html_report_20250317_152018.html
2025-03-17 15:20:18,345 - INFO - modules.excel_analyzer - 已自动打开综合HTML报告: reports/comprehensive_html_report_20250317_152018.html
2025-03-17 15:20:18,345 - INFO - modules.excel_analyzer - 综合分析报告已生成: reports/comprehensive_html_report_20250317_152018.html
2025-03-17 15:20:18,346 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_152018.md
2025-03-17 15:20:18,347 - INFO - __main__ - HTML图表报告已保存到: reports/html_report_20250317_151857.html
2025-03-17 15:22:42,598 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 15:22:42,599 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 15:22:42,599 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 15:22:42,599 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 15:22:42,599 - INFO - __main__ - 初始化Excel分析器
2025-03-17 15:22:42,600 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 15:22:42,600 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 15:22:42,600 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 15:22:42,600 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 15:22:42,600 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 15:22:42,600 - INFO - modules.analysis_dispatcher - 成功初始化 4 个分析单元
2025-03-17 15:22:42,601 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 15:22:42,601 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 15:22:42,601 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 15:22:42,601 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 15:22:42,601 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 15:22:42,601 - INFO - modules.analysis_dispatcher - 成功初始化 4 个分析单元
2025-03-17 15:22:42,601 - INFO - __main__ - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 15:22:42,602 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 15:22:42,602 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/5g_station_data_2025_03_01.xlsx
2025-03-17 15:22:43,466 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317152243.csv
2025-03-17 15:22:43,466 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317152243.csv
2025-03-17 15:22:43,507 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 15:22:43,508 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 15:22:43,508 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 15:22:43,509 - INFO - modules.analysis_dispatcher - 执行分析单元 1/4: 总体数据统计分析单元
2025-03-17 15:22:43,509 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 15:22:43,509 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 15:22:43,510 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:22:43,510 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:22:47,218 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:22:47,219 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:24:16,600 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:24:16,603 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 15:24:16,604 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 15:24:16,604 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 15:24:16,606 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 15:24:16,607 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 15:24:16,995 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 15:24:16,996 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 15:24:16,996 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 15:24:16,997 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 总体数据统计分析单元 生成Markdown报告...
2025-03-17 15:24:16,997 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:24:16,997 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:24:16,997 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:24:16,998 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:24:22,651 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:24:22,653 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:26:10,417 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:26:10,435 - INFO - modules.analysis_dispatcher - 已为分析单元 总体数据统计分析单元 生成独立的Markdown报告: reports\总体数据统计分析_20250317_152610.md
2025-03-17 15:26:10,435 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 15:26:10,436 - INFO - modules.analysis_dispatcher - 执行分析单元 2/4: 分组对比分析单元
2025-03-17 15:26:10,436 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 正在生成数据分析代码...
2025-03-17 15:26:10,436 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 15:26:10,437 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:26:10,437 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:26:15,153 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:26:15,155 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:27:48,578 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:27:48,580 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功从Python代码块中提取代码
2025-03-17 15:27:48,581 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功生成数据分析代码
2025-03-17 15:27:48,581 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 开始执行并尝试修复代码...
2025-03-17 15:27:48,582 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 执行代码尝试 1/3
2025-03-17 15:27:48,582 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 在沙箱环境中执行代码...
2025-03-17 15:27:48,970 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行成功
2025-03-17 15:27:48,970 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行成功（尝试 1/3）
2025-03-17 15:27:48,971 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_分组对比分析单元_conclusion.txt
2025-03-17 15:27:48,972 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 分组对比分析单元 生成Markdown报告...
2025-03-17 15:27:48,972 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:27:48,972 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:27:48,972 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:27:48,973 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:27:55,437 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:27:55,441 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:28:11,952 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:28:11,960 - INFO - modules.analysis_dispatcher - 已为分析单元 分组对比分析单元 生成独立的Markdown报告: reports\分组对比分析_20250317_152811.md
2025-03-17 15:28:11,961 - INFO - modules.analysis_dispatcher - 分析单元 分组对比分析单元 执行成功
2025-03-17 15:28:11,962 - INFO - modules.analysis_dispatcher - 执行分析单元 3/4: 比例分析单元
2025-03-17 15:28:11,963 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 正在生成数据分析代码...
2025-03-17 15:28:11,964 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 15:28:11,966 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:28:11,967 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:28:15,287 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:28:15,288 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:28:40,100 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:28:40,110 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 成功从Python代码块中提取代码
2025-03-17 15:28:40,111 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 成功生成数据分析代码
2025-03-17 15:28:40,113 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 开始执行并尝试修复代码...
2025-03-17 15:28:40,115 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 执行代码尝试 1/3
2025-03-17 15:28:40,116 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 在沙箱环境中执行代码...
2025-03-17 15:28:40,491 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 代码执行成功
2025-03-17 15:28:40,491 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 代码执行成功（尝试 1/3）
2025-03-17 15:28:40,492 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\3_比例分析单元_conclusion.txt
2025-03-17 15:28:40,493 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 比例分析单元 生成Markdown报告...
2025-03-17 15:28:40,493 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:28:40,493 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:28:40,493 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:28:40,493 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:28:45,075 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:28:45,076 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:29:22,351 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:29:22,362 - INFO - modules.analysis_dispatcher - 已为分析单元 比例分析单元 生成独立的Markdown报告: reports\比例分析_20250317_152922.md
2025-03-17 15:29:22,362 - INFO - modules.analysis_dispatcher - 分析单元 比例分析单元 执行成功
2025-03-17 15:29:22,362 - INFO - modules.analysis_dispatcher - 执行分析单元 4/4: 时间趋势分析单元
2025-03-17 15:29:22,363 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在生成数据分析代码...
2025-03-17 15:29:22,363 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 15:29:22,364 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:29:22,364 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:29:28,284 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:29:28,285 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:29:39,664 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:29:39,666 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功从Python代码块中提取代码
2025-03-17 15:29:39,666 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功生成数据分析代码
2025-03-17 15:29:39,666 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 开始执行并尝试修复代码...
2025-03-17 15:29:39,667 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 执行代码尝试 1/3
2025-03-17 15:29:39,667 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 在沙箱环境中执行代码...
2025-03-17 15:29:40,486 - WARNING - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行失败，错误码: 1
2025-03-17 15:29:40,486 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行失败，尝试修复（尝试 1/3）
2025-03-17 15:29:40,487 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在修复数据分析代码...
2025-03-17 15:29:40,487 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 尝试调用API修复代码（流式输出）...
2025-03-17 15:29:40,487 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:29:40,487 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:30:01,520 - ERROR - modules.model_connector - API流式请求异常 (尝试 1/3): HTTPSConnectionPool(host='xiaohumini.site', port=443): Max retries exceeded with url: /v1/chat/completions (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x000001E4B79A7D90>, 'Connection to xiaohumini.site timed out. (connect timeout=60)'))
2025-03-17 15:30:01,520 - INFO - modules.model_connector - 2秒后重试...
2025-03-17 15:30:03,521 - INFO - modules.model_connector - 尝试流式调用API (尝试 2/3)...
2025-03-17 15:30:03,521 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:30:07,432 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:30:07,434 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:30:47,069 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:30:47,071 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功从Python代码块中提取代码
2025-03-17 15:30:47,071 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功修复数据分析代码
2025-03-17 15:30:47,071 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 执行代码尝试 2/3
2025-03-17 15:30:47,071 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 在沙箱环境中执行代码...
2025-03-17 15:30:47,893 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功
2025-03-17 15:30:47,894 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功（尝试 2/3）
2025-03-17 15:30:47,895 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\4_时间趋势分析单元_conclusion.txt
2025-03-17 15:30:47,895 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 时间趋势分析单元 生成Markdown报告...
2025-03-17 15:30:47,895 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:30:47,896 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:30:47,896 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:30:47,896 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:30:51,710 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:30:51,711 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:31:37,461 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:31:37,465 - INFO - modules.analysis_dispatcher - 已为分析单元 时间趋势分析单元 生成独立的Markdown报告: reports\时间趋势分析_20250317_153137.md
2025-03-17 15:31:37,465 - INFO - modules.analysis_dispatcher - 分析单元 时间趋势分析单元 执行成功
2025-03-17 15:31:37,467 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_152243
2025-03-17 15:31:37,467 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 4/4
2025-03-17 15:31:37,467 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 15:31:37,467 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 15:31:37,467 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:31:37,467 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:31:37,468 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:31:37,468 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:31:37,468 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:31:58,486 - ERROR - modules.model_connector - API流式请求异常 (尝试 1/3): HTTPSConnectionPool(host='xiaohumini.site', port=443): Max retries exceeded with url: /v1/chat/completions (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x000001E4B79A7390>, 'Connection to xiaohumini.site timed out. (connect timeout=60)'))
2025-03-17 15:31:58,488 - INFO - modules.model_connector - 2秒后重试...
2025-03-17 15:32:00,490 - INFO - modules.model_connector - 尝试流式调用API (尝试 2/3)...
2025-03-17 15:32:00,492 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:32:09,197 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:32:09,198 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:32:25,004 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:32:25,020 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports/html_report_20250317_153225.html
2025-03-17 15:32:25,119 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports/html_report_20250317_153225.html
2025-03-17 15:32:25,121 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\总体数据统计分析_20250317_152610.html
2025-03-17 15:32:25,138 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\总体数据统计分析_20250317_152610.html
2025-03-17 15:32:25,139 - INFO - modules.excel_analyzer - 已将分析单元 总体数据统计分析单元 的Markdown报告转换为HTML: reports\总体数据统计分析_20250317_152610.html
2025-03-17 15:32:25,140 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\分组对比分析_20250317_152811.html
2025-03-17 15:32:25,182 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\分组对比分析_20250317_152811.html
2025-03-17 15:32:25,182 - INFO - modules.excel_analyzer - 已将分析单元 分组对比分析单元 的Markdown报告转换为HTML: reports\分组对比分析_20250317_152811.html
2025-03-17 15:32:25,183 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\比例分析_20250317_152922.html
2025-03-17 15:32:25,217 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\比例分析_20250317_152922.html
2025-03-17 15:32:25,218 - INFO - modules.excel_analyzer - 已将分析单元 比例分析单元 的Markdown报告转换为HTML: reports\比例分析_20250317_152922.html
2025-03-17 15:32:25,219 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\时间趋势分析_20250317_153137.html
2025-03-17 15:32:25,266 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\时间趋势分析_20250317_153137.html
2025-03-17 15:32:25,266 - INFO - modules.excel_analyzer - 已将分析单元 时间趋势分析单元 的Markdown报告转换为HTML: reports\时间趋势分析_20250317_153137.html
2025-03-17 15:32:25,294 - INFO - modules.excel_analyzer - 已自动打开HTML报告: reports/html_report_20250317_153225.html
2025-03-17 15:32:25,345 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\总体数据统计分析_20250317_152610.html
2025-03-17 15:32:25,367 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\分组对比分析_20250317_152811.html
2025-03-17 15:32:25,401 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\比例分析_20250317_152922.html
2025-03-17 15:32:25,439 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\时间趋势分析_20250317_153137.html
2025-03-17 15:32:25,440 - INFO - modules.excel_analyzer - 开始生成综合分析报告...
2025-03-17 15:32:25,440 - INFO - modules.excel_analyzer - 开始生成综合分析报告...
2025-03-17 15:32:25,441 - INFO - modules.excel_analyzer - 开始流式生成综合Markdown报告...
2025-03-17 15:32:25,441 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:32:25,441 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:32:25,442 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:32:25,442 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:32:30,393 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:32:30,395 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:33:47,846 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:33:47,862 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports/comprehensive_html_report_20250317_153347.html
2025-03-17 15:33:47,882 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports/comprehensive_html_report_20250317_153347.html
2025-03-17 15:33:47,900 - INFO - modules.excel_analyzer - 已自动打开综合HTML报告: reports/comprehensive_html_report_20250317_153347.html
2025-03-17 15:33:47,901 - INFO - modules.excel_analyzer - 综合分析报告已生成: reports/comprehensive_html_report_20250317_153347.html
2025-03-17 15:33:47,902 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_153347.md
2025-03-17 15:33:47,902 - INFO - __main__ - HTML图表报告已保存到: reports/html_report_20250317_153225.html
2025-03-17 15:45:09,641 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 15:45:09,641 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 15:45:09,641 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 15:45:09,641 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 15:45:09,641 - INFO - __main__ - 初始化Excel分析器
2025-03-17 15:45:09,642 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 15:45:09,642 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 15:45:09,642 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 15:45:09,642 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 15:45:09,642 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 15:45:09,642 - INFO - modules.analysis_dispatcher - 成功初始化 4 个分析单元
2025-03-17 15:45:09,643 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 15:45:09,643 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 15:45:09,643 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 15:45:09,643 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 15:45:09,643 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 15:45:09,643 - INFO - modules.analysis_dispatcher - 成功初始化 4 个分析单元
2025-03-17 15:45:09,643 - INFO - __main__ - 开始分析Excel文件: sample_data/customer_complaints_data_2025_Q1.xlsx
2025-03-17 15:45:09,643 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/customer_complaints_data_2025_Q1.xlsx
2025-03-17 15:45:09,644 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/customer_complaints_data_2025_Q1.xlsx
2025-03-17 15:45:09,916 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317154509.csv
2025-03-17 15:45:09,917 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317154509.csv
2025-03-17 15:45:09,930 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 15:45:09,930 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 15:45:09,930 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 15:45:09,931 - INFO - modules.analysis_dispatcher - 执行分析单元 1/4: 总体数据统计分析单元
2025-03-17 15:45:09,932 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 15:45:09,932 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 15:45:09,932 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:45:09,932 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:45:13,322 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:45:13,322 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:46:04,458 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:46:04,465 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 15:46:04,465 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 15:46:04,466 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 15:46:04,467 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 15:46:04,467 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 15:46:04,825 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 15:46:04,825 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 15:46:04,826 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 15:46:04,826 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 总体数据统计分析单元 生成Markdown报告...
2025-03-17 15:46:04,827 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:46:04,827 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:46:04,827 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:46:04,827 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:46:09,627 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:46:09,628 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:46:21,561 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:46:21,566 - INFO - modules.analysis_dispatcher - 已为分析单元 总体数据统计分析单元 生成独立的Markdown报告: reports\总体数据统计分析_20250317_154621.md
2025-03-17 15:46:21,567 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 15:46:21,567 - INFO - modules.analysis_dispatcher - 执行分析单元 2/4: 分组对比分析单元
2025-03-17 15:46:21,567 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 正在生成数据分析代码...
2025-03-17 15:46:21,567 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 15:46:21,568 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:46:21,568 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:46:28,315 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:46:28,319 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:47:25,052 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:47:25,065 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 从不完整的Python代码块中提取代码
2025-03-17 15:47:25,067 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功生成数据分析代码
2025-03-17 15:47:25,068 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 开始执行并尝试修复代码...
2025-03-17 15:47:25,071 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 执行代码尝试 1/3
2025-03-17 15:47:25,072 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 在沙箱环境中执行代码...
2025-03-17 15:47:25,397 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行成功
2025-03-17 15:47:25,397 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行失败，尝试修复（尝试 1/3）
2025-03-17 15:47:25,397 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 正在修复数据分析代码...
2025-03-17 15:47:25,397 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 尝试调用API修复代码（流式输出）...
2025-03-17 15:47:25,398 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:47:25,398 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:47:30,171 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:47:30,173 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:48:08,951 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:48:08,954 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功从Python代码块中提取代码
2025-03-17 15:48:08,954 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功修复数据分析代码
2025-03-17 15:48:08,955 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 执行代码尝试 2/3
2025-03-17 15:48:08,955 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 在沙箱环境中执行代码...
2025-03-17 15:49:08,973 - ERROR - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行超时
2025-03-17 15:49:08,975 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行失败，尝试修复（尝试 2/3）
2025-03-17 15:49:08,977 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 正在修复数据分析代码...
2025-03-17 15:49:08,978 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 尝试调用API修复代码（流式输出）...
2025-03-17 15:49:08,982 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:49:08,983 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:49:12,474 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:49:12,478 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:50:04,807 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:50:04,811 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功从Python代码块中提取代码
2025-03-17 15:50:04,811 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功修复数据分析代码
2025-03-17 15:50:04,811 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 执行代码尝试 3/3
2025-03-17 15:50:04,811 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 在沙箱环境中执行代码...
2025-03-17 15:51:04,821 - ERROR - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行超时
2025-03-17 15:51:04,822 - WARNING - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 达到最大尝试次数 (3)，终止修复流程
2025-03-17 15:51:04,823 - ERROR - modules.analysis_dispatcher - 分析单元 分组对比分析单元 执行代码失败: 代码执行超时（超过60秒）
2025-03-17 15:51:04,823 - INFO - modules.analysis_dispatcher - 执行分析单元 3/4: 比例分析单元
2025-03-17 15:51:04,824 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 正在生成数据分析代码...
2025-03-17 15:51:04,824 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 15:51:04,827 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:51:04,829 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:51:08,248 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:51:08,248 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:51:37,967 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:51:37,976 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 成功从Python代码块中提取代码
2025-03-17 15:51:37,978 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 成功生成数据分析代码
2025-03-17 15:51:37,980 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 开始执行并尝试修复代码...
2025-03-17 15:51:37,984 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 执行代码尝试 1/3
2025-03-17 15:51:37,985 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 在沙箱环境中执行代码...
2025-03-17 15:51:38,322 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 代码执行成功
2025-03-17 15:51:38,323 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 代码执行成功（尝试 1/3）
2025-03-17 15:51:38,323 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\3_比例分析单元_conclusion.txt
2025-03-17 15:51:38,324 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 比例分析单元 生成Markdown报告...
2025-03-17 15:51:38,324 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:51:38,324 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:51:38,324 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:51:38,324 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:51:42,627 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:51:42,628 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:52:38,681 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:52:38,686 - INFO - modules.analysis_dispatcher - 已为分析单元 比例分析单元 生成独立的Markdown报告: reports\比例分析_20250317_155238.md
2025-03-17 15:52:38,687 - INFO - modules.analysis_dispatcher - 分析单元 比例分析单元 执行成功
2025-03-17 15:52:38,687 - INFO - modules.analysis_dispatcher - 执行分析单元 4/4: 时间趋势分析单元
2025-03-17 15:52:38,687 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在生成数据分析代码...
2025-03-17 15:52:38,687 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 15:52:38,687 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:52:38,688 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:52:42,979 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:52:42,982 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:53:44,682 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:53:44,685 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功从Python代码块中提取代码
2025-03-17 15:53:44,685 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功生成数据分析代码
2025-03-17 15:53:44,685 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 开始执行并尝试修复代码...
2025-03-17 15:53:44,686 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 执行代码尝试 1/3
2025-03-17 15:53:44,686 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 在沙箱环境中执行代码...
2025-03-17 15:53:45,048 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功
2025-03-17 15:53:45,048 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功（尝试 1/3）
2025-03-17 15:53:45,049 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\4_时间趋势分析单元_conclusion.txt
2025-03-17 15:53:45,049 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 时间趋势分析单元 生成Markdown报告...
2025-03-17 15:53:45,049 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:53:45,049 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:53:45,050 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:53:45,050 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:53:49,018 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:53:49,019 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:54:31,905 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:54:31,915 - INFO - modules.analysis_dispatcher - 已为分析单元 时间趋势分析单元 生成独立的Markdown报告: reports\时间趋势分析_20250317_155431.md
2025-03-17 15:54:31,916 - INFO - modules.analysis_dispatcher - 分析单元 时间趋势分析单元 执行成功
2025-03-17 15:54:31,917 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_154509
2025-03-17 15:54:31,917 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 3/4
2025-03-17 15:54:31,918 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 15:54:31,918 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 15:54:31,918 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:54:31,918 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:54:31,918 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:54:31,918 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:54:31,918 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:54:36,978 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:54:36,981 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:55:55,089 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:55:55,096 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports/html_report_20250317_155555.html
2025-03-17 15:55:55,187 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports/html_report_20250317_155555.html
2025-03-17 15:55:55,188 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\总体数据统计分析_20250317_154621.html
2025-03-17 15:55:55,207 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\总体数据统计分析_20250317_154621.html
2025-03-17 15:55:55,207 - INFO - modules.excel_analyzer - 已将分析单元 总体数据统计分析单元 的Markdown报告转换为HTML: reports\总体数据统计分析_20250317_154621.html
2025-03-17 15:55:55,209 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\比例分析_20250317_155238.html
2025-03-17 15:55:55,243 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\比例分析_20250317_155238.html
2025-03-17 15:55:55,244 - INFO - modules.excel_analyzer - 已将分析单元 比例分析单元 的Markdown报告转换为HTML: reports\比例分析_20250317_155238.html
2025-03-17 15:55:55,245 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\时间趋势分析_20250317_155431.html
2025-03-17 15:55:55,289 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\时间趋势分析_20250317_155431.html
2025-03-17 15:55:55,290 - INFO - modules.excel_analyzer - 已将分析单元 时间趋势分析单元 的Markdown报告转换为HTML: reports\时间趋势分析_20250317_155431.html
2025-03-17 15:55:55,317 - INFO - modules.excel_analyzer - 已自动打开HTML报告: reports/html_report_20250317_155555.html
2025-03-17 15:55:55,364 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\总体数据统计分析_20250317_154621.html
2025-03-17 15:55:55,385 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\比例分析_20250317_155238.html
2025-03-17 15:55:55,423 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\时间趋势分析_20250317_155431.html
2025-03-17 15:55:55,424 - INFO - modules.excel_analyzer - 开始生成综合分析报告...
2025-03-17 15:55:55,424 - INFO - modules.excel_analyzer - 开始生成综合分析报告...
2025-03-17 15:55:55,424 - INFO - modules.excel_analyzer - 开始流式生成综合Markdown报告...
2025-03-17 15:55:55,425 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 15:55:55,425 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 15:55:55,425 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 15:55:55,425 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 15:56:00,524 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 15:56:00,525 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 15:57:20,291 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 15:57:20,303 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports/comprehensive_html_report_20250317_155720.html
2025-03-17 15:57:20,330 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports/comprehensive_html_report_20250317_155720.html
2025-03-17 15:57:20,348 - INFO - modules.excel_analyzer - 已自动打开综合HTML报告: reports/comprehensive_html_report_20250317_155720.html
2025-03-17 15:57:20,348 - INFO - modules.excel_analyzer - 综合分析报告已生成: reports/comprehensive_html_report_20250317_155720.html
2025-03-17 15:57:20,349 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_155720.md
2025-03-17 15:57:20,349 - INFO - __main__ - HTML图表报告已保存到: reports/html_report_20250317_155555.html
2025-03-17 16:00:56,644 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 16:00:56,645 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 16:00:56,645 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 16:00:56,645 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 16:00:56,645 - INFO - __main__ - 初始化Excel分析器
2025-03-17 16:00:56,645 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 16:00:56,645 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 16:00:56,645 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 16:00:56,645 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 16:00:56,646 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 16:00:56,646 - INFO - modules.analysis_dispatcher - 成功初始化 4 个分析单元
2025-03-17 16:00:56,646 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 16:00:56,646 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 16:00:56,646 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 16:00:56,646 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 16:00:56,646 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 16:00:56,646 - INFO - modules.analysis_dispatcher - 成功初始化 4 个分析单元
2025-03-17 16:00:56,646 - INFO - __main__ - 开始分析Excel文件: sample_data/customer_complaints_data_2025_Q1.xlsx
2025-03-17 16:00:56,647 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/customer_complaints_data_2025_Q1.xlsx
2025-03-17 16:00:56,647 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/customer_complaints_data_2025_Q1.xlsx
2025-03-17 16:00:56,921 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317160056.csv
2025-03-17 16:00:56,921 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317160056.csv
2025-03-17 16:00:56,934 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 16:00:56,934 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 16:00:56,934 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 16:00:56,935 - INFO - modules.analysis_dispatcher - 执行分析单元 1/4: 总体数据统计分析单元
2025-03-17 16:00:56,936 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 16:00:56,936 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 16:00:56,936 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 16:00:56,936 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 16:01:00,569 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 16:01:00,569 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 16:01:58,632 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 16:01:58,634 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 16:01:58,635 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 16:01:58,635 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 16:01:58,635 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 16:01:58,635 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 16:01:58,975 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 16:01:58,976 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 16:01:58,977 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 16:01:58,978 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 总体数据统计分析单元 生成Markdown报告...
2025-03-17 16:01:58,978 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 16:01:58,978 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 16:01:58,978 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 16:01:58,978 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 16:02:01,976 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 16:02:01,979 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 16:03:01,251 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 16:03:01,263 - INFO - modules.analysis_dispatcher - 已为分析单元 总体数据统计分析单元 生成独立的Markdown报告: reports\总体数据统计分析_20250317_160301.md
2025-03-17 16:03:01,263 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 16:03:01,264 - INFO - modules.analysis_dispatcher - 执行分析单元 2/4: 分组对比分析单元
2025-03-17 16:03:01,264 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 正在生成数据分析代码...
2025-03-17 16:03:01,265 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 16:03:01,265 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 16:03:01,266 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 16:03:07,780 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 16:03:07,782 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 16:03:19,364 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 16:03:19,369 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功从Python代码块中提取代码
2025-03-17 16:03:19,370 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功生成数据分析代码
2025-03-17 16:03:19,370 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 开始执行并尝试修复代码...
2025-03-17 16:03:19,372 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 执行代码尝试 1/3
2025-03-17 16:03:19,372 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 在沙箱环境中执行代码...
2025-03-17 16:03:19,700 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行成功
2025-03-17 16:03:19,700 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行成功（尝试 1/3）
2025-03-17 16:03:19,701 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_分组对比分析单元_conclusion.txt
2025-03-17 16:03:19,701 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 分组对比分析单元 生成Markdown报告...
2025-03-17 16:03:19,701 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 16:03:19,701 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 16:03:19,702 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 16:03:19,702 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 16:03:25,096 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 16:03:25,097 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 16:03:37,355 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 16:03:37,371 - INFO - modules.analysis_dispatcher - 已为分析单元 分组对比分析单元 生成独立的Markdown报告: reports\分组对比分析_20250317_160337.md
2025-03-17 16:03:37,372 - INFO - modules.analysis_dispatcher - 分析单元 分组对比分析单元 执行成功
2025-03-17 16:03:37,373 - INFO - modules.analysis_dispatcher - 执行分析单元 3/4: 比例分析单元
2025-03-17 16:03:37,373 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 正在生成数据分析代码...
2025-03-17 16:03:37,373 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 16:03:37,375 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 16:03:37,376 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 16:03:40,935 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 16:03:40,936 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 16:04:11,226 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 16:04:11,231 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 成功从Python代码块中提取代码
2025-03-17 16:04:11,232 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 成功生成数据分析代码
2025-03-17 16:04:11,233 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 开始执行并尝试修复代码...
2025-03-17 16:04:11,234 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 执行代码尝试 1/3
2025-03-17 16:04:11,234 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 在沙箱环境中执行代码...
2025-03-17 16:04:11,579 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 代码执行成功
2025-03-17 16:04:11,579 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 代码执行成功（尝试 1/3）
2025-03-17 16:04:11,580 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\3_比例分析单元_conclusion.txt
2025-03-17 16:04:11,581 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 比例分析单元 生成Markdown报告...
2025-03-17 16:04:11,581 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 16:04:11,581 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 16:04:11,581 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 16:04:11,581 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 16:04:14,947 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 16:04:14,949 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 16:04:14,967 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 16:04:14,969 - WARNING - modules.enhanced_markdown_report_generator - 输入内容为空
2025-03-17 16:04:14,970 - ERROR - modules.enhanced_markdown_report_generator - 无法提取有效的报告内容
2025-03-17 16:04:14,970 - WARNING - modules.analysis_dispatcher - 大模型未能生成分析单元 比例分析单元 的报告，将使用默认格式
2025-03-17 16:04:14,971 - INFO - modules.analysis_dispatcher - 已为分析单元 比例分析单元 生成独立的Markdown报告: reports\比例分析_20250317_160414.md
2025-03-17 16:04:14,972 - INFO - modules.analysis_dispatcher - 分析单元 比例分析单元 执行成功
2025-03-17 16:04:14,972 - INFO - modules.analysis_dispatcher - 执行分析单元 4/4: 时间趋势分析单元
2025-03-17 16:04:14,972 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在生成数据分析代码...
2025-03-17 16:04:14,974 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 16:04:14,976 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 16:04:14,977 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 16:04:19,824 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 16:04:19,825 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 16:04:31,778 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 16:04:31,780 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 从不完整的Python代码块中提取代码
2025-03-17 16:04:31,780 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功生成数据分析代码
2025-03-17 16:04:31,780 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 开始执行并尝试修复代码...
2025-03-17 16:04:31,780 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 执行代码尝试 1/3
2025-03-17 16:04:31,780 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 在沙箱环境中执行代码...
2025-03-17 16:04:32,581 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功
2025-03-17 16:04:32,581 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行失败，尝试修复（尝试 1/3）
2025-03-17 16:04:32,582 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在修复数据分析代码...
2025-03-17 16:04:32,582 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 尝试调用API修复代码（流式输出）...
2025-03-17 16:04:32,582 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 16:04:32,582 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 16:04:37,834 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 16:04:37,836 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 16:05:40,337 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 16:05:40,344 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功从Python代码块中提取代码
2025-03-17 16:05:40,346 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 成功修复数据分析代码
2025-03-17 16:05:40,348 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 执行代码尝试 2/3
2025-03-17 16:05:40,349 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 在沙箱环境中执行代码...
2025-03-17 16:05:41,158 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功
2025-03-17 16:05:41,158 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 代码执行成功（尝试 2/3）
2025-03-17 16:05:41,159 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\4_时间趋势分析单元_conclusion.txt
2025-03-17 16:05:41,160 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 时间趋势分析单元 生成Markdown报告...
2025-03-17 16:05:41,160 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 16:05:41,160 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 16:05:41,161 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 16:05:41,161 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 16:05:45,540 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 16:05:45,541 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 16:06:51,595 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 16:06:51,598 - INFO - modules.analysis_dispatcher - 已为分析单元 时间趋势分析单元 生成独立的Markdown报告: reports\时间趋势分析_20250317_160651.md
2025-03-17 16:06:51,599 - INFO - modules.analysis_dispatcher - 分析单元 时间趋势分析单元 执行成功
2025-03-17 16:06:51,600 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_160056
2025-03-17 16:06:51,600 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 4/4
2025-03-17 16:06:51,600 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 16:06:51,600 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 16:06:51,600 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 16:06:51,601 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 16:06:51,601 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 16:06:51,601 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 16:06:51,601 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 16:07:00,044 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 16:07:00,045 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 16:08:31,037 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 16:08:31,047 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports/html_report_20250317_160831.html
2025-03-17 16:08:31,138 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports/html_report_20250317_160831.html
2025-03-17 16:08:31,139 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\总体数据统计分析_20250317_160301.html
2025-03-17 16:08:31,155 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\总体数据统计分析_20250317_160301.html
2025-03-17 16:08:31,155 - INFO - modules.excel_analyzer - 已将分析单元 总体数据统计分析单元 的Markdown报告转换为HTML: reports\总体数据统计分析_20250317_160301.html
2025-03-17 16:08:31,156 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\分组对比分析_20250317_160337.html
2025-03-17 16:08:31,199 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\分组对比分析_20250317_160337.html
2025-03-17 16:08:31,200 - INFO - modules.excel_analyzer - 已将分析单元 分组对比分析单元 的Markdown报告转换为HTML: reports\分组对比分析_20250317_160337.html
2025-03-17 16:08:31,204 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\比例分析_20250317_160414.html
2025-03-17 16:08:31,236 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\比例分析_20250317_160414.html
2025-03-17 16:08:31,236 - INFO - modules.excel_analyzer - 已将分析单元 比例分析单元 的Markdown报告转换为HTML: reports\比例分析_20250317_160414.html
2025-03-17 16:08:31,237 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\时间趋势分析_20250317_160651.html
2025-03-17 16:08:31,266 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\时间趋势分析_20250317_160651.html
2025-03-17 16:08:31,267 - INFO - modules.excel_analyzer - 已将分析单元 时间趋势分析单元 的Markdown报告转换为HTML: reports\时间趋势分析_20250317_160651.html
2025-03-17 16:08:31,292 - INFO - modules.excel_analyzer - 已自动打开HTML报告: reports/html_report_20250317_160831.html
2025-03-17 16:08:31,332 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\总体数据统计分析_20250317_160301.html
2025-03-17 16:08:31,351 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\分组对比分析_20250317_160337.html
2025-03-17 16:08:31,393 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\比例分析_20250317_160414.html
2025-03-17 16:08:31,421 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\时间趋势分析_20250317_160651.html
2025-03-17 16:08:31,422 - INFO - modules.excel_analyzer - 开始生成综合分析报告...
2025-03-17 16:08:31,422 - INFO - modules.excel_analyzer - 开始生成综合分析报告...
2025-03-17 16:08:31,423 - INFO - modules.excel_analyzer - 开始流式生成综合Markdown报告...
2025-03-17 16:08:31,423 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 16:08:31,423 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 16:08:31,424 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 16:08:31,424 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 16:08:38,254 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 16:08:38,257 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 16:08:38,404 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 16:08:38,412 - WARNING - modules.enhanced_markdown_report_generator - 无法提取有效的Markdown，返回原始内容
2025-03-17 16:08:38,417 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports/comprehensive_html_report_20250317_160838.html
2025-03-17 16:08:38,436 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports/comprehensive_html_report_20250317_160838.html
2025-03-17 16:08:38,451 - INFO - modules.excel_analyzer - 已自动打开综合HTML报告: reports/comprehensive_html_report_20250317_160838.html
2025-03-17 16:08:38,452 - INFO - modules.excel_analyzer - 综合分析报告已生成: reports/comprehensive_html_report_20250317_160838.html
2025-03-17 16:08:38,452 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_160838.md
2025-03-17 16:08:38,452 - INFO - __main__ - HTML图表报告已保存到: reports/html_report_20250317_160831.html
2025-03-17 16:11:54,616 - INFO - __main__ - 成功加载配置文件: config.yaml
2025-03-17 16:11:54,617 - INFO - __main__ - 初始化模型连接器 (模型: claude-3-7-sonnet-20250219)
2025-03-17 16:11:54,617 - INFO - modules.model_connector - 初始化模型连接器: 类型=openai, 模型=claude-3-7-sonnet-20250219
2025-03-17 16:11:54,617 - INFO - modules.model_connector - API调用参数: 超时=60秒, 最大重试次数=3, 重试间隔=2秒
2025-03-17 16:11:54,617 - INFO - __main__ - 初始化Excel分析器
2025-03-17 16:11:54,617 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 16:11:54,617 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 16:11:54,617 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 16:11:54,617 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 16:11:54,618 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 16:11:54,618 - INFO - modules.analysis_dispatcher - 成功初始化 4 个分析单元
2025-03-17 16:11:54,618 - INFO - modules.analysis_dispatcher - 初始化分析单元...
2025-03-17 16:11:54,618 - INFO - modules.analysis_dispatcher - 已启用通用统计分析单元
2025-03-17 16:11:54,618 - INFO - modules.analysis_dispatcher - 已启用柱状图分析单元
2025-03-17 16:11:54,618 - INFO - modules.analysis_dispatcher - 已启用饼图分析单元
2025-03-17 16:11:54,618 - INFO - modules.analysis_dispatcher - 已启用时间趋势分析单元
2025-03-17 16:11:54,618 - INFO - modules.analysis_dispatcher - 成功初始化 4 个分析单元
2025-03-17 16:11:54,618 - INFO - __main__ - 开始分析Excel文件: sample_data/network_traffic_data_2025_02.xlsx
2025-03-17 16:11:54,619 - INFO - modules.excel_analyzer - 开始分析Excel文件: sample_data/network_traffic_data_2025_02.xlsx
2025-03-17 16:11:54,619 - INFO - modules.excel_analyzer - 将Excel文件转换为CSV: sample_data/network_traffic_data_2025_02.xlsx
2025-03-17 16:11:58,366 - INFO - modules.excel_analyzer - 已将Excel转换为CSV: temp_csv/excel_data_20250317161158.csv
2025-03-17 16:11:58,367 - INFO - modules.excel_analyzer - 分析CSV文件结构: temp_csv/excel_data_20250317161158.csv
2025-03-17 16:11:58,463 - INFO - modules.excel_analyzer - 成功分析CSV文件结构
2025-03-17 16:11:58,464 - INFO - modules.excel_analyzer - 使用分析调度器运行所有分析单元...
2025-03-17 16:11:58,464 - INFO - modules.analysis_dispatcher - 开始运行分析调度器...
2025-03-17 16:11:58,465 - INFO - modules.analysis_dispatcher - 执行分析单元 1/4: 总体数据统计分析单元
2025-03-17 16:11:58,465 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 正在生成数据分析代码...
2025-03-17 16:11:58,466 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 16:11:58,466 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 16:11:58,466 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 16:12:01,049 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 16:12:01,050 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 16:12:48,399 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 16:12:48,404 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功从Python代码块中提取代码
2025-03-17 16:12:48,404 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 成功生成数据分析代码
2025-03-17 16:12:48,405 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 开始执行并尝试修复代码...
2025-03-17 16:12:48,406 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 执行代码尝试 1/3
2025-03-17 16:12:48,406 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 在沙箱环境中执行代码...
2025-03-17 16:12:48,880 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功
2025-03-17 16:12:48,881 - INFO - modules.analysis_units.base_analysis_unit - [总体数据统计分析单元] 代码执行成功（尝试 1/3）
2025-03-17 16:12:48,881 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\1_总体数据统计分析单元_conclusion.txt
2025-03-17 16:12:48,882 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 总体数据统计分析单元 生成Markdown报告...
2025-03-17 16:12:48,882 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 16:12:48,882 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 16:12:48,882 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 16:12:48,883 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 16:12:53,933 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 16:12:53,934 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 16:14:38,092 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 16:14:38,119 - INFO - modules.analysis_dispatcher - 已为分析单元 总体数据统计分析单元 生成独立的Markdown报告: reports\总体数据统计分析_20250317_161438.md
2025-03-17 16:14:38,120 - INFO - modules.analysis_dispatcher - 分析单元 总体数据统计分析单元 执行成功
2025-03-17 16:14:38,120 - INFO - modules.analysis_dispatcher - 执行分析单元 2/4: 分组对比分析单元
2025-03-17 16:14:38,120 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 正在生成数据分析代码...
2025-03-17 16:14:38,120 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 16:14:38,121 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 16:14:38,121 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 16:14:42,972 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 16:14:42,976 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 16:16:04,519 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 16:16:04,522 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功从Python代码块中提取代码
2025-03-17 16:16:04,522 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 成功生成数据分析代码
2025-03-17 16:16:04,522 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 开始执行并尝试修复代码...
2025-03-17 16:16:04,523 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 执行代码尝试 1/3
2025-03-17 16:16:04,523 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 在沙箱环境中执行代码...
2025-03-17 16:16:04,986 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行成功
2025-03-17 16:16:04,986 - INFO - modules.analysis_units.base_analysis_unit - [分组对比分析单元] 代码执行成功（尝试 1/3）
2025-03-17 16:16:04,987 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\2_分组对比分析单元_conclusion.txt
2025-03-17 16:16:04,987 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 分组对比分析单元 生成Markdown报告...
2025-03-17 16:16:04,988 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 16:16:04,988 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 16:16:04,988 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 16:16:04,988 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 16:16:10,154 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 16:16:10,155 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 16:17:21,570 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 16:17:21,584 - INFO - modules.analysis_dispatcher - 已为分析单元 分组对比分析单元 生成独立的Markdown报告: reports\分组对比分析_20250317_161721.md
2025-03-17 16:17:21,585 - INFO - modules.analysis_dispatcher - 分析单元 分组对比分析单元 执行成功
2025-03-17 16:17:21,586 - INFO - modules.analysis_dispatcher - 执行分析单元 3/4: 比例分析单元
2025-03-17 16:17:21,587 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 正在生成数据分析代码...
2025-03-17 16:17:21,587 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 16:17:21,587 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 16:17:21,587 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 16:17:24,729 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 16:17:24,732 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 16:17:49,584 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 16:17:49,587 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 成功从Python代码块中提取代码
2025-03-17 16:17:49,587 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 成功生成数据分析代码
2025-03-17 16:17:49,588 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 开始执行并尝试修复代码...
2025-03-17 16:17:49,588 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 执行代码尝试 1/3
2025-03-17 16:17:49,588 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 在沙箱环境中执行代码...
2025-03-17 16:17:49,966 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 代码执行成功
2025-03-17 16:17:49,966 - INFO - modules.analysis_units.base_analysis_unit - [比例分析单元] 代码执行成功（尝试 1/3）
2025-03-17 16:17:49,967 - INFO - modules.analysis_dispatcher - 已将分析结论保存到临时文件: D:\smolagent\temp_txts\3_比例分析单元_conclusion.txt
2025-03-17 16:17:49,967 - INFO - modules.analysis_dispatcher - 开始使用大模型为分析单元 比例分析单元 生成Markdown报告...
2025-03-17 16:17:49,968 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 16:17:49,968 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 16:17:49,968 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 16:17:49,968 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 16:17:52,923 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 16:17:52,924 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 16:18:21,791 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 16:18:21,795 - INFO - modules.analysis_dispatcher - 已为分析单元 比例分析单元 生成独立的Markdown报告: reports\比例分析_20250317_161821.md
2025-03-17 16:18:21,795 - INFO - modules.analysis_dispatcher - 分析单元 比例分析单元 执行成功
2025-03-17 16:18:21,795 - INFO - modules.analysis_dispatcher - 执行分析单元 4/4: 时间趋势分析单元
2025-03-17 16:18:21,795 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 正在生成数据分析代码...
2025-03-17 16:18:21,796 - INFO - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 尝试调用API生成代码（流式输出）...
2025-03-17 16:18:21,796 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 16:18:21,796 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 16:18:25,772 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 16:18:25,775 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 16:18:25,928 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 16:18:25,937 - WARNING - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 无法从响应中提取Python代码
2025-03-17 16:18:25,937 - ERROR - modules.analysis_units.base_analysis_unit - [时间趋势分析单元] 生成数据分析代码失败: 无法从响应中提取Python代码
2025-03-17 16:18:25,938 - INFO - modules.analysis_units.base_analysis_unit - 已将完整提示词保存到: debug/model_prompt_debug_20250317161825.txt
2025-03-17 16:18:25,942 - INFO - modules.analysis_units.base_analysis_unit - 已将完整响应内容保存到: debug/model_response_debug_20250317161825.txt
2025-03-17 16:18:25,943 - ERROR - modules.analysis_dispatcher - 分析单元 时间趋势分析单元 生成代码失败，跳过此单元
2025-03-17 16:18:25,951 - INFO - modules.analysis_dispatcher - 分析调度器执行完成，结果已保存到: D:\smolagent\analysis_results\analysis_session_20250317_161158
2025-03-17 16:18:25,953 - INFO - modules.analysis_dispatcher - 成功执行的分析单元: 3/4
2025-03-17 16:18:25,954 - INFO - modules.excel_analyzer - 生成Markdown报告...
2025-03-17 16:18:25,955 - INFO - modules.enhanced_markdown_report_generator - 从分析结果生成Markdown报告...
2025-03-17 16:18:25,955 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 16:18:25,955 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 16:18:25,955 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 16:18:25,955 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 16:18:25,955 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 16:18:31,697 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 16:18:31,698 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 16:20:00,334 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 16:20:00,339 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports/html_report_20250317_162000.html
2025-03-17 16:20:00,430 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports/html_report_20250317_162000.html
2025-03-17 16:20:00,431 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\总体数据统计分析_20250317_161438.html
2025-03-17 16:20:00,446 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\总体数据统计分析_20250317_161438.html
2025-03-17 16:20:00,447 - INFO - modules.excel_analyzer - 已将分析单元 总体数据统计分析单元 的Markdown报告转换为HTML: reports\总体数据统计分析_20250317_161438.html
2025-03-17 16:20:00,449 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\分组对比分析_20250317_161721.html
2025-03-17 16:20:00,487 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\分组对比分析_20250317_161721.html
2025-03-17 16:20:00,488 - INFO - modules.excel_analyzer - 已将分析单元 分组对比分析单元 的Markdown报告转换为HTML: reports\分组对比分析_20250317_161721.html
2025-03-17 16:20:00,488 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports\比例分析_20250317_161821.html
2025-03-17 16:20:00,528 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports\比例分析_20250317_161821.html
2025-03-17 16:20:00,528 - INFO - modules.excel_analyzer - 已将分析单元 比例分析单元 的Markdown报告转换为HTML: reports\比例分析_20250317_161821.html
2025-03-17 16:20:00,556 - INFO - modules.excel_analyzer - 已自动打开HTML报告: reports/html_report_20250317_162000.html
2025-03-17 16:20:00,597 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\总体数据统计分析_20250317_161438.html
2025-03-17 16:20:00,619 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\分组对比分析_20250317_161721.html
2025-03-17 16:20:00,659 - INFO - modules.excel_analyzer - 已自动打开分析单元HTML报告: reports\比例分析_20250317_161821.html
2025-03-17 16:20:00,659 - INFO - modules.excel_analyzer - 开始生成综合分析报告...
2025-03-17 16:20:00,659 - INFO - modules.excel_analyzer - 开始生成综合分析报告...
2025-03-17 16:20:00,660 - INFO - modules.excel_analyzer - 开始流式生成综合Markdown报告...
2025-03-17 16:20:00,660 - INFO - modules.enhanced_markdown_report_generator - 开始生成报告...
2025-03-17 16:20:00,660 - INFO - modules.enhanced_markdown_report_generator - 开始流式生成Markdown报告...
2025-03-17 16:20:00,661 - INFO - modules.model_connector - 尝试流式调用API (尝试 1/3)...
2025-03-17 16:20:00,661 - INFO - modules.model_connector - 直接流式连接API（无代理）
2025-03-17 16:20:06,422 - INFO - modules.model_connector - API流式响应状态: 200 OK
2025-03-17 16:20:06,423 - INFO - modules.model_connector - 开始接收流式响应...
2025-03-17 16:21:37,244 - INFO - modules.model_connector - 流式响应接收完成
2025-03-17 16:21:37,266 - INFO - modules.enhanced_markdown_report_generator - 已将Markdown渲染为HTML并保存到: reports/comprehensive_html_report_20250317_162137.html
2025-03-17 16:21:37,291 - INFO - modules.enhanced_markdown_report_generator - 已自动打开HTML报告: reports/comprehensive_html_report_20250317_162137.html
2025-03-17 16:21:37,310 - INFO - modules.excel_analyzer - 已自动打开综合HTML报告: reports/comprehensive_html_report_20250317_162137.html
2025-03-17 16:21:37,310 - INFO - modules.excel_analyzer - 综合分析报告已生成: reports/comprehensive_html_report_20250317_162137.html
2025-03-17 16:21:37,311 - INFO - __main__ - 分析完成，Markdown报告已保存到: reports/excel_analysis_report_20250317_162137.md
2025-03-17 16:21:37,311 - INFO - __main__ - HTML图表报告已保存到: reports/html_report_20250317_162000.html
